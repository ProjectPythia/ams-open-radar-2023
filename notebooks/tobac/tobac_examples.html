
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D tobac Tutorial: Gridded Radar Data &#8212; AMS Open Radar Short Course 2023</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PyDDA" href="../pydda/README.html" />
    <link rel="prev" title="TOBAC Tutorial" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="132">
    <div class="container-fluid" id="shim"></div>
    <div class="container-fluid" id="banner"></div>
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://openradarscience.org">
  <img src="../../_static/pythia_logo-white-rtext.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://openradarscience.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/radar-cookbook">Radar Cookbook</a>
  </li>
  
  
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openradar" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" rel="noopener" target="_blank" title="YouTube">
            <span><i class="fab fa-youtube-square"></i></span>
            <label class="sr-only">YouTube</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    <div class="container-xl">
      <div class="row">
        
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   AMS Open Radar Short Course 2023
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pyart/README.html">
   Py-ART Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-basics.html">
     Py-ART Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-corrections.html">
     Py-ART Corrections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-gridding.html">
     Py-ART Gridding
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../wradlib/README.html">
   Wradlib Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_intro.html">
     An Overview of wradlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_radar_data_io_vis.html">
     wradlib radar data io, visualisation, gridding and gis export
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_data_quality.html">
     wradlib data quality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_differential_phase.html">
     wradlib Phase Processing - System PhiDP - ZPHI-Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_quasi_vertical_profiles.html">
     wradlib time series data and quasi vertical profiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lrose/README.html">
   LROSE Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lrose/LROSE_Wind_tutorial.html">
     LROSE Wind Tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   TOBAC Tutorial
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3D
     <em>
      tobac
     </em>
     Tutorial: Gridded Radar Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pydda/README.html">
   PyDDA
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pydda/Retrieving_winds_with_pydda.html">
     PyDDA tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../baltrad/README.html">
   BALTRAD Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20Compositing.html">
     Compositing with BALTRAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20DRQC.html">
     In this notebook, we will use the depolarization ratio to quality control a volume of data from the new radar at Radisson, Saskatchewan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20IO.html">
     BALTRAD I/O model - making sense out of data and metadata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20parallel%20processing.html">
     BALTRAD parallel processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20QC.html">
     BALTRAD Quality Control
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by <a href="https://projectpythia.org">Project Pythia</a>.<br><br>

</div>

</div>

        

        <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main"><div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/tobac/tobac_examples.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/openradar/ams-open-radar-2023/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/openradar/ams-open-radar-2023//issues/new?title=Issue%20on%20page%20%2Fnotebooks/tobac/tobac_examples.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/openradar/ams-open-radar-2023/edit/main/notebooks/tobac/tobac_examples.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="http://binder.projectpythia.org/v2/gh/openradar/ams-open-radar-2023/main?urlpath=lab/tree/notebooks/tobac/tobac_examples.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jupyterhub-workshop.svcs.arm.gov//hub/user-redirect/git-pull?repo=https://github.com/openradar/ams-open-radar-2023/&urlpath=lab/tree/ams-open-radar-2023/notebooks/tobac/tobac_examples.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> On this page
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   3D
   <em>
    tobac
   </em>
   Tutorial: Gridded Radar Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-input">
     DATA INPUT:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-data-we-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters">
       <em>
        tobac
       </em>
       is designed to work with
       <strong>
        gridded
       </strong>
       data currently, so using pre-gridded data, or data we must first grid the radial radar data. This is a quick and dirty gridding, but it will get the job done for this tutorial. Much better gridding results could be had with tuning of the parameters.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both">
       Let’s Look at the data - there’s a number of ways to do a quick look, we’re going to use pcolormesh. We can look at a specific level of the data, or create a composite reflectivity. Let’s do both!
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d">
     We’re going to start simple before getting more complicated: tracking in 2D
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-thresholds">
   Multiple Thresholds
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-tracking">
   3d Tracking
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube">
     Notice that the field we’re tracking on has switched from the 2d composite reflectivity field to the 3D reflectivity field (still in an iris cube).
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
          <div id="main-content" class="row">
            <div class="col-12 col-md-9 pl-md-3 pr-md-0">
              
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="d-tobac-tutorial-gridded-radar-data">
<h1>3D <em>tobac</em> Tutorial: Gridded Radar Data<a class="headerlink" href="#d-tobac-tutorial-gridded-radar-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<p>This tutorial will demonstrate how to use <em>tobac</em> to detect and track convection with gridded radar data. Because this tutorial uses 3D feature detection, you must use the v1.5 (3D and PBC changes) of <em>tobac</em>.</p>
<p>This tutorial requires the use of pre-gridded radar data, which we generated during the Py-ART tutorial.</p>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pyart</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>## You are using the Python ARM Radar Toolkit (Py-ART), an open source
## library for working with weather radar data. Py-ART is partly
## supported by the U.S. Department of Energy as part of the Atmospheric
## Radiation Measurement (ARM) Climate Research Facility, an Office of
## Science user facility.
##
## If you use this software to prepare a publication, please cite:
##
##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-input">
<h2>DATA INPUT:<a class="headerlink" href="#data-input" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>https://tobac.readthedocs.io/en/latest/data_input.html</p>
<p>We use the gridded data from the Py-ART tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridded_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;../../data/uah-armor/gridded/*.nc&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">gridded_files</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (time: 25, z: 30, y: 600, x: 600)
Coordinates:
  * time          (time) datetime64[ns] 2008-04-11T18:12:23 ... 2008-04-11T20...
  * z             (z) float64 0.0 517.2 1.034e+03 ... 1.448e+04 1.5e+04
    lat           (y, x) float64 dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;
    lon           (y, x) float64 dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;
  * y             (y) float64 -1.5e+05 -1.495e+05 ... 1.495e+05 1.5e+05
  * x             (x) float64 -1.5e+05 -1.495e+05 ... 1.495e+05 1.5e+05
Data variables:
    reflectivity  (time, z, y, x) float32 dask.array&lt;chunksize=(1, 30, 600, 600), meta=np.ndarray&gt;
    ROI           (time, z, y, x) float32 dask.array&lt;chunksize=(1, 30, 600, 600), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a9fc2cd9-2139-4cd8-9557-14e651774e81' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a9fc2cd9-2139-4cd8-9557-14e651774e81' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 25</li><li><span class='xr-has-index'>z</span>: 30</li><li><span class='xr-has-index'>y</span>: 600</li><li><span class='xr-has-index'>x</span>: 600</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d3c37564-3dde-42bb-a609-90fb260a9702' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d3c37564-3dde-42bb-a609-90fb260a9702' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2008-04-11T18:12:23 ... 2008-04-...</div><input id='attrs-564ca07b-39db-4472-a374-c048a3f3badd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-564ca07b-39db-4472-a374-c048a3f3badd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88cad2c0-88b2-4bf9-ad0c-ae69cc08c285' class='xr-var-data-in' type='checkbox'><label for='data-88cad2c0-88b2-4bf9-ad0c-ae69cc08c285' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11T18:12:23.000000000&#x27;, &#x27;2008-04-11T18:17:23.000000000&#x27;,
       &#x27;2008-04-11T18:22:42.000000000&#x27;, &#x27;2008-04-11T18:27:41.000000000&#x27;,
       &#x27;2008-04-11T18:33:08.000000000&#x27;, &#x27;2008-04-11T18:38:35.000000000&#x27;,
       &#x27;2008-04-11T18:44:18.000000000&#x27;, &#x27;2008-04-11T18:49:44.000000000&#x27;,
       &#x27;2008-04-11T18:55:11.000000000&#x27;, &#x27;2008-04-11T19:00:23.000000000&#x27;,
       &#x27;2008-04-11T19:05:35.000000000&#x27;, &#x27;2008-04-11T19:10:47.000000000&#x27;,
       &#x27;2008-04-11T19:15:59.000000000&#x27;, &#x27;2008-04-11T19:21:11.000000000&#x27;,
       &#x27;2008-04-11T19:26:22.000000000&#x27;, &#x27;2008-04-11T19:31:35.000000000&#x27;,
       &#x27;2008-04-11T19:36:46.000000000&#x27;, &#x27;2008-04-11T19:41:59.000000000&#x27;,
       &#x27;2008-04-11T19:47:10.000000000&#x27;, &#x27;2008-04-11T19:52:22.000000000&#x27;,
       &#x27;2008-04-11T19:57:34.000000000&#x27;, &#x27;2008-04-11T20:04:21.000000000&#x27;,
       &#x27;2008-04-11T20:09:49.000000000&#x27;, &#x27;2008-04-11T20:15:30.000000000&#x27;,
       &#x27;2008-04-11T20:20:58.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>z</span></div><div class='xr-var-dims'>(z)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 517.2 ... 1.448e+04 1.5e+04</div><input id='attrs-3afa68a4-31c8-4bc9-9b91-20c0e0e0c311' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3afa68a4-31c8-4bc9-9b91-20c0e0e0c311' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e3d926c-5950-4826-9b8c-8f14480c826c' class='xr-var-data-in' type='checkbox'><label for='data-7e3d926c-5950-4826-9b8c-8f14480c826c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_z_coordinate</dd><dt><span>long_name :</span></dt><dd>Z distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>array([    0.      ,   517.241379,  1034.482759,  1551.724138,  2068.965517,
        2586.206897,  3103.448276,  3620.689655,  4137.931034,  4655.172414,
        5172.413793,  5689.655172,  6206.896552,  6724.137931,  7241.37931 ,
        7758.62069 ,  8275.862069,  8793.103448,  9310.344828,  9827.586207,
       10344.827586, 10862.068966, 11379.310345, 11896.551724, 12413.793103,
       12931.034483, 13448.275862, 13965.517241, 14482.758621, 15000.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;</div><input id='attrs-60a15d15-edb5-4ccb-be0d-55c260c5a23b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60a15d15-edb5-4ccb-be0d-55c260c5a23b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-869ca783-263a-4f84-b057-7e0d6ea72d76' class='xr-var-data-in' type='checkbox'><label for='data-869ca783-263a-4f84-b057-7e0d6ea72d76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_N</dd><dt><span>standard_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.75 MiB </td>
                        <td> 2.75 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (600, 600) </td>
                        <td> (600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 120 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="120" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="140.000000" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,60.000000)">600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;</div><input id='attrs-9c7f8253-703d-401e-85ad-dbb5a7eb66c1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c7f8253-703d-401e-85ad-dbb5a7eb66c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-375a45c5-e711-4c84-be85-7dbb3dcc8a8c' class='xr-var-data-in' type='checkbox'><label for='data-375a45c5-e711-4c84-be85-7dbb3dcc8a8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_E</dd><dt><span>standard_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.75 MiB </td>
                        <td> 2.75 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (600, 600) </td>
                        <td> (600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 120 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="120" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="140.000000" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,60.000000)">600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-bcb5bfbd-84ae-4dbd-bcb9-505a7ab9c48c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bcb5bfbd-84ae-4dbd-bcb9-505a7ab9c48c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84d7fe84-0a27-4d79-9673-6f19ff5b5d12' class='xr-var-data-in' type='checkbox'><label for='data-84d7fe84-0a27-4d79-9673-6f19ff5b5d12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>long_name :</span></dt><dd>Y distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000.      , -149499.165275, -148998.330551, ...,  148998.330551,
        149499.165275,  150000.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-25ace727-19e0-49a4-a807-8651e1cc720d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-25ace727-19e0-49a4-a807-8651e1cc720d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0351a6a0-b5dc-42d3-974c-2520c60dabee' class='xr-var-data-in' type='checkbox'><label for='data-0351a6a0-b5dc-42d3-974c-2520c60dabee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>long_name :</span></dt><dd>X distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000.      , -149499.165275, -148998.330551, ...,  148998.330551,
        149499.165275,  150000.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-361d9f83-8a9e-4704-8b40-2556e5893d8b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-361d9f83-8a9e-4704-8b40-2556e5893d8b' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity</span></div><div class='xr-var-dims'>(time, z, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 30, 600, 600), meta=np.ndarray&gt;</div><input id='attrs-009d91fe-e5d3-4a94-8cbf-f94c62e9cf43' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-009d91fe-e5d3-4a94-8cbf-f94c62e9cf43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-548d22f7-0ba1-4f02-abaf-272389d40585' class='xr-var-data-in' type='checkbox'><label for='data-548d22f7-0ba1-4f02-abaf-272389d40585' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>coordinates :</span></dt><dd>elevation azimuth range</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.01 GiB </td>
                        <td> 41.20 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (25, 30, 600, 600) </td>
                        <td> (1, 30, 600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 25 chunks in 51 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="396" height="190" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="33" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="33" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 33.38369844152673,0.0 33.38369844152673,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="16.691849" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >25</text>
  <text x="53.383698" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,53.383698,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="103" y1="120" x2="123" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="103" y2="120" style="stroke-width:2" />
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 123.29471539635256,20.294715396352554 123.29471539635256,140.29471539635256 103.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="223" y2="0" style="stroke-width:2" />
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="223" y1="0" x2="243" y2="20" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 223.0,0.0 243.29471539635256,20.294715396352554 123.29471539635256,20.294715396352554" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />
  <line x1="123" y1="140" x2="243" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />
  <line x1="243" y1="20" x2="243" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="123.29471539635256,20.294715396352554 243.29471539635256,20.294715396352554 243.29471539635256,140.29471539635256 123.29471539635256,140.29471539635256" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="183.294715" y="160.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="263.294715" y="80.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,263.294715,80.294715)">600</text>
  <text x="103.147358" y="150.147358" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,103.147358,150.147358)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ROI</span></div><div class='xr-var-dims'>(time, z, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 30, 600, 600), meta=np.ndarray&gt;</div><input id='attrs-c605e757-d0cc-48e1-8338-6e199ee6156d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c605e757-d0cc-48e1-8338-6e199ee6156d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a41c3a5a-bbe5-47e0-9669-c71f59cd19c7' class='xr-var-data-in' type='checkbox'><label for='data-a41c3a5a-bbe5-47e0-9669-c71f59cd19c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>radius_of_influence</dd><dt><span>long_name :</span></dt><dd>Radius of influence for mapping</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.01 GiB </td>
                        <td> 41.20 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (25, 30, 600, 600) </td>
                        <td> (1, 30, 600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 25 chunks in 51 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="396" height="190" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="33" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="33" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 33.38369844152673,0.0 33.38369844152673,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="16.691849" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >25</text>
  <text x="53.383698" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,53.383698,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="103" y1="120" x2="123" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="103" y2="120" style="stroke-width:2" />
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 123.29471539635256,20.294715396352554 123.29471539635256,140.29471539635256 103.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="223" y2="0" style="stroke-width:2" />
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="223" y1="0" x2="243" y2="20" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 223.0,0.0 243.29471539635256,20.294715396352554 123.29471539635256,20.294715396352554" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />
  <line x1="123" y1="140" x2="243" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />
  <line x1="243" y1="20" x2="243" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="123.29471539635256,20.294715396352554 243.29471539635256,20.294715396352554 243.29471539635256,140.29471539635256 123.29471539635256,140.29471539635256" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="183.294715" y="160.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="263.294715" y="80.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,263.294715,80.294715)">600</text>
  <text x="103.147358" y="150.147358" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,103.147358,150.147358)">30</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-42ed80d4-7b2f-4463-ab3b-402e6dbb6f25' class='xr-section-summary-in' type='checkbox'  ><label for='section-42ed80d4-7b2f-4463-ab3b-402e6dbb6f25' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9df8c42d-24a9-46ca-9bc1-693b95f01751' class='xr-index-data-in' type='checkbox'/><label for='index-9df8c42d-24a9-46ca-9bc1-693b95f01751' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2008-04-11 18:12:23&#x27;, &#x27;2008-04-11 18:17:23&#x27;,
               &#x27;2008-04-11 18:22:42&#x27;, &#x27;2008-04-11 18:27:41&#x27;,
               &#x27;2008-04-11 18:33:08&#x27;, &#x27;2008-04-11 18:38:35&#x27;,
               &#x27;2008-04-11 18:44:18&#x27;, &#x27;2008-04-11 18:49:44&#x27;,
               &#x27;2008-04-11 18:55:11&#x27;, &#x27;2008-04-11 19:00:23&#x27;,
               &#x27;2008-04-11 19:05:35&#x27;, &#x27;2008-04-11 19:10:47&#x27;,
               &#x27;2008-04-11 19:15:59&#x27;, &#x27;2008-04-11 19:21:11&#x27;,
               &#x27;2008-04-11 19:26:22&#x27;, &#x27;2008-04-11 19:31:35&#x27;,
               &#x27;2008-04-11 19:36:46&#x27;, &#x27;2008-04-11 19:41:59&#x27;,
               &#x27;2008-04-11 19:47:10&#x27;, &#x27;2008-04-11 19:52:22&#x27;,
               &#x27;2008-04-11 19:57:34&#x27;, &#x27;2008-04-11 20:04:21&#x27;,
               &#x27;2008-04-11 20:09:49&#x27;, &#x27;2008-04-11 20:15:30&#x27;,
               &#x27;2008-04-11 20:20:58&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>z</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-aaeca182-87da-43d0-8c3a-9a673ad3f588' class='xr-index-data-in' type='checkbox'/><label for='index-aaeca182-87da-43d0-8c3a-9a673ad3f588' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([               0.0,  517.2413793103449, 1034.4827586206898,
              1551.7241379310346, 2068.9655172413795, 2586.2068965517246,
              3103.4482758620693,  3620.689655172414,  4137.931034482759,
               4655.172413793104,  5172.413793103449, 5689.6551724137935,
               6206.896551724139,  6724.137931034484,  7241.379310344828,
               7758.620689655173,  8275.862068965518,  8793.103448275862,
               9310.344827586208,  9827.586206896553, 10344.827586206899,
              10862.068965517243, 11379.310344827587, 11896.551724137933,
              12413.793103448277, 12931.034482758621, 13448.275862068967,
              13965.517241379312, 14482.758620689656,            15000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;z&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4ef0166e-daee-4d9b-88c1-26111edeb2bf' class='xr-index-data-in' type='checkbox'/><label for='index-4ef0166e-daee-4d9b-88c1-26111edeb2bf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([          -150000.0,  -149499.1652754591,  -148998.3305509182,
               -148497.4958263773,  -147996.6611018364, -147495.82637729548,
               -146994.9916527546,  -146494.1569282137, -145993.32220367278,
              -145492.48747913187,
              ...
                145492.4874791319,  145993.32220367278,  146494.15692821366,
                146994.9916527546,  147495.82637729548,  147996.66110183642,
                148497.4958263773,  148998.33055091818,  149499.16527545912,
                         150000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0e36f125-0234-4fe5-82be-842f9032e24d' class='xr-index-data-in' type='checkbox'/><label for='index-0e36f125-0234-4fe5-82be-842f9032e24d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([          -150000.0,  -149499.1652754591,  -148998.3305509182,
               -148497.4958263773,  -147996.6611018364, -147495.82637729548,
               -146994.9916527546,  -146494.1569282137, -145993.32220367278,
              -145492.48747913187,
              ...
                145492.4874791319,  145993.32220367278,  146494.15692821366,
                146994.9916527546,  147495.82637729548,  147996.66110183642,
                148497.4958263773,  148998.33055091818,  149499.16527545912,
                         150000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=600))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ef92468-9fa1-42e5-b331-43c368d55700' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8ef92468-9fa1-42e5-b331-43c368d55700' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="section" id="tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-data-we-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters">
<h3><em>tobac</em> is designed to work with <strong>gridded</strong> data currently, so using pre-gridded data, or data we must first grid the radial radar data. This is a quick and dirty gridding, but it will get the job done for this tutorial. Much better gridding results could be had with tuning of the parameters.<a class="headerlink" href="#tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-data-we-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
</div>
<div class="section" id="lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both">
<h3>Let’s Look at the data - there’s a number of ways to do a quick look, we’re going to use pcolormesh. We can look at a specific level of the data, or create a composite reflectivity. Let’s do both!<a class="headerlink" href="#lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Looking at a specific level and time of our data</span>
<span class="n">ds</span><span class="o">.</span><span class="n">reflectivity</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2a2cdd2d0&gt;
</pre></div>
</div>
<img alt="../../_images/b48acdd61f864eba270a8cb7e33e03431c730de147145c7a8b79dda0507af92e.png" src="../../_images/b48acdd61f864eba270a8cb7e33e03431c730de147145c7a8b79dda0507af92e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#QUICK COMPOSITE REFLECTIVITY HERE:</span>
<span class="n">maxrefl</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;reflectivity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxrefl</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x2ac8a7370&gt;
</pre></div>
</div>
<img alt="../../_images/c5cbb21e25e99ebe937e1f4cbd7e6244a53b430358db9b775f636c0809078000.png" src="../../_images/c5cbb21e25e99ebe937e1f4cbd7e6244a53b430358db9b775f636c0809078000.png" />
</div>
</div>
<p>Load in <em>tobac</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tobac</span>
<span class="kn">import</span> <span class="nn">tobac.testing</span>
<span class="kn">import</span> <span class="nn">tobac.feature_detection</span>
<span class="kn">import</span> <span class="nn">tobac.segmentation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_detection_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="c1">#, 40, 50]</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;maximum&#39;</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;position_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;weighted_diff&#39;</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;n_erosion_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;sigma_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;n_min_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<p>Note that to track in 3D, we must give information about what our height coordinate is. Iris tends to be picky about the naming conventions, so we need to assign standard names as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;altitude&quot;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;latitude&quot;</span>
<span class="n">ds</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;longitude&quot;</span>

<span class="n">xr_grid_full</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;reflectivity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Even though we read in our data using Xarray, and Xarray is our data handler of choice (could also be Pandas)</span>
<span class="c1">#we need to conver this data to iris cubes. Future versions of tobac will be built on Xarray, but for now we convert.</span>
<span class="n">grid_iris</span> <span class="o">=</span> <span class="n">xr_grid_full</span><span class="o">.</span><span class="n">to_iris</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># #FURTHER, to use tobac we need to know the grid spacing in both x/y/z and time:</span>
<span class="c1"># # #Dt, DXY</span>
<span class="c1"># datetimes = xr_grid_full[&#39;time&#39;]</span>
<span class="c1"># timedeltas = [(datetimes[i-1]-datetimes[i]).astype(&#39;timedelta64[m]&#39;) for i in range(1, len(datetimes))]</span>
<span class="c1"># print(len(timedeltas))</span>
<span class="c1"># average_timedelta = sum(timedeltas) / len(timedeltas)</span>
<span class="c1"># dt = np.abs(np.array(average_timedelta)).astype(&#39;timedelta64[m]&#39;).astype(int)</span>


<span class="c1"># deltax = [xr_grid_full[&#39;x&#39;][i-1]-xr_grid_full[&#39;x&#39;][i] for i in range(1, len(xr_grid_full[&#39;x&#39;]))]</span>
<span class="c1"># dxy = np.abs(np.mean(deltax).astype(int))/1000</span>


<span class="c1"># print(dxy,dt)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dxy</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_spacings</span><span class="p">(</span><span class="n">grid_iris</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dxy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>500.8347245409095
300
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#I also want to define a save directory. </span>
<span class="c1">#Set up directory to save output and plots:</span>
<span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;tobac_Save&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">savedir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">savedir</span><span class="p">)</span>
<span class="n">plot_dir</span><span class="o">=</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/tobac_Plot&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d">
<h2>We’re going to start simple before getting more complicated: tracking in 2D<a class="headerlink" href="#were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a composite reflectivity to get started, turning our 3D reflectivity into 2D:</span>
<span class="n">maxrefl</span> <span class="o">=</span> <span class="n">xr_grid_full</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Convert to iris:</span>
<span class="n">maxrefl_iris</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="o">.</span><span class="n">to_iris</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">maxrefl_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="n">Features</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Features.nc&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;features saved&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting feature detection based on multiple thresholds
feature detection done
features saved
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (index: 1014)
Coordinates:
  * index                    (index) int64 0 1 2 3 4 ... 1010 1011 1012 1013
Data variables: (12/13)
    frame                    (index) int64 0 0 0 0 0 0 0 ... 24 24 24 24 24 24
    idx                      (index) int64 1 2 3 4 6 7 8 ... 65 66 67 68 69 71
    hdim_1                   (index) float64 190.9 305.6 232.7 ... 467.1 536.8
    hdim_2                   (index) float64 217.4 132.7 187.5 ... 428.8 359.8
    num                      (index) int64 1079 9688 75 5 7 ... 223 12 15 37 7
    threshold_value          (index) int64 30 30 30 30 30 30 ... 30 30 30 30 30
    ...                       ...
    time                     (index) object 2008-04-11 18:12:23 ... 2008-04-1...
    timestr                  (index) object &#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-0...
    projection_y_coordinate  (index) float64 -5.438e+04 3.059e+03 ... 1.188e+05
    projection_x_coordinate  (index) float64 -4.111e+04 -8.352e+04 ... 3.019e+04
    latitude                 (index) float64 34.16 34.67 34.34 ... 35.4 35.71
    longitude                (index) float64 -87.22 -87.68 ... -86.06 -86.44</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d72e0f9a-7de3-40b5-b7dd-664dbf068076' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d72e0f9a-7de3-40b5-b7dd-664dbf068076' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>index</span>: 1014</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7c2e0ad5-b3bc-49df-8099-155c9fbeb021' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7c2e0ad5-b3bc-49df-8099-155c9fbeb021' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>index</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 1010 1011 1012 1013</div><input id='attrs-323bbf1a-0f9d-4bb9-a22a-caea59fe7ad5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-323bbf1a-0f9d-4bb9-a22a-caea59fe7ad5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9088bfa7-1704-4aad-a588-1b711e52d506' class='xr-var-data-in' type='checkbox'><label for='data-9088bfa7-1704-4aad-a588-1b711e52d506' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 1011, 1012, 1013])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b5b7c090-9464-4442-8330-d36ba9549f61' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b5b7c090-9464-4442-8330-d36ba9549f61' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frame</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 ... 24 24 24 24 24 24</div><input id='attrs-8de9358b-8589-461b-b115-56576ece3f48' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8de9358b-8589-461b-b115-56576ece3f48' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ee6c4f65-d1c9-4c74-83c4-5f4cdb18fe43' class='xr-var-data-in' type='checkbox'><label for='data-ee6c4f65-d1c9-4c74-83c4-5f4cdb18fe43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  0,  0, ..., 24, 24, 24])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>idx</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 6 7 8 ... 65 66 67 68 69 71</div><input id='attrs-747e3a09-31dc-4856-a9cd-aee27f462795' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-747e3a09-31dc-4856-a9cd-aee27f462795' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2cb0bccf-ff75-43c1-9dbc-fe07afb390fd' class='xr-var-data-in' type='checkbox'><label for='data-2cb0bccf-ff75-43c1-9dbc-fe07afb390fd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3, ..., 68, 69, 71])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_1</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>190.9 305.6 232.7 ... 467.1 536.8</div><input id='attrs-5fc15189-b779-465a-abb2-9a4f64c88fe2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5fc15189-b779-465a-abb2-9a4f64c88fe2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bed7ef7e-a249-4838-87be-6f223ed446a0' class='xr-var-data-in' type='checkbox'><label for='data-bed7ef7e-a249-4838-87be-6f223ed446a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([190.92310225, 305.60827423, 232.65435517, ..., 458.50261951,
       467.11951224, 536.78037042])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_2</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>217.4 132.7 187.5 ... 428.8 359.8</div><input id='attrs-ff9021ce-ff03-4592-991f-8042e828e6ae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff9021ce-ff03-4592-991f-8042e828e6ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-478ff1a6-8980-4788-b1d6-36c97790ffb9' class='xr-var-data-in' type='checkbox'><label for='data-478ff1a6-8980-4788-b1d6-36c97790ffb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([217.42111362, 132.73303546, 187.47522731, ..., 423.53552979,
       428.78326059, 359.78507397])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1079 9688 75 5 7 ... 223 12 15 37 7</div><input id='attrs-d96f930f-ba47-4ccd-b11d-399091e85710' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d96f930f-ba47-4ccd-b11d-399091e85710' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8648a577-c516-4f1e-8821-d0bff42142fc' class='xr-var-data-in' type='checkbox'><label for='data-8648a577-c516-4f1e-8821-d0bff42142fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1079, 9688,   75, ...,   15,   37,    7])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>threshold_value</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>30 30 30 30 30 ... 30 30 30 30 30</div><input id='attrs-03268dc2-c922-42d3-9ef4-238e678ab01b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-03268dc2-c922-42d3-9ef4-238e678ab01b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cdafbed3-a847-4099-a4a3-093330a2802b' class='xr-var-data-in' type='checkbox'><label for='data-cdafbed3-a847-4099-a4a3-093330a2802b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([30, 30, 30, ..., 30, 30, 30])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 ... 1011 1012 1013 1014</div><input id='attrs-20d1d0b1-82f3-4754-9b42-8209eb72e9d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-20d1d0b1-82f3-4754-9b42-8209eb72e9d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-508becc3-dcd0-4a35-ad98-2c110bfbb2b2' class='xr-var-data-in' type='checkbox'><label for='data-508becc3-dcd0-4a35-ad98-2c110bfbb2b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   1,    2,    3, ..., 1012, 1013, 1014])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2008-04-11 18:12:23 ... 2008-04-...</div><input id='attrs-e4404531-7240-438f-a407-6b592d3ac8eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e4404531-7240-438f-a407-6b592d3ac8eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9616f18c-452b-482b-af96-b86de1445fe8' class='xr-var-data-in' type='checkbox'><label for='data-9616f18c-452b-482b-af96-b86de1445fe8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       ...,
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>timestr</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-...</div><input id='attrs-ddf48fb3-4c24-42ab-9104-2a0463a1f1d4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ddf48fb3-4c24-42ab-9104-2a0463a1f1d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba7d1af7-8fe4-4707-971a-bbef97adc1da' class='xr-var-data-in' type='checkbox'><label for='data-ba7d1af7-8fe4-4707-971a-bbef97adc1da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11 18:12:23&#x27;, &#x27;2008-04-11 18:12:23&#x27;,
       &#x27;2008-04-11 18:12:23&#x27;, ..., &#x27;2008-04-11 20:20:58&#x27;,
       &#x27;2008-04-11 20:20:58&#x27;, &#x27;2008-04-11 20:20:58&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_y_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.438e+04 3.059e+03 ... 1.188e+05</div><input id='attrs-a4e32944-1a70-4c22-9a5e-dfb76577092b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4e32944-1a70-4c22-9a5e-dfb76577092b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-820058cb-6cd8-4eaf-9f16-6673b9feb001' class='xr-var-data-in' type='checkbox'><label for='data-820058cb-6cd8-4eaf-9f16-6673b9feb001' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-54379.08067544,   3059.23584341, -33478.62011565, ...,
        79634.03314329,  83949.6722385 , 118838.24895707])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_x_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-4.111e+04 -8.352e+04 ... 3.019e+04</div><input id='attrs-4b90d534-4dbd-42c8-ae30-4f950b07f89a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4b90d534-4dbd-42c8-ae30-4f950b07f89a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5ae3fd6f-52c5-454c-9059-862bf8ca6595' class='xr-var-data-in' type='checkbox'><label for='data-5ae3fd6f-52c5-454c-9059-862bf8ca6595' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-41107.95644928, -83522.68674834, -56105.89617347, ...,
        62121.30039404,  64749.54620303,  30192.8584164 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>34.16 34.67 34.34 ... 35.4 35.71</div><input id='attrs-2d183a8a-2b91-43a3-a9bc-86879aa72d01' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2d183a8a-2b91-43a3-a9bc-86879aa72d01' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0018edd1-0716-490a-9385-0d2cbe511147' class='xr-var-data-in' type='checkbox'><label for='data-0018edd1-0716-490a-9385-0d2cbe511147' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([34.15634087, 34.67030806, 34.34359344, ..., 35.36045623,
       35.39910102, 35.71448396])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.22 -87.68 ... -86.06 -86.44</div><input id='attrs-e15e8e5a-a986-41b1-84c2-b7ff35e0242c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e15e8e5a-a986-41b1-84c2-b7ff35e0242c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2ae6b0a-115e-4d79-add5-84d64f34542a' class='xr-var-data-in' type='checkbox'><label for='data-b2ae6b0a-115e-4d79-add5-84d64f34542a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-87.21825008, -87.68481782, -87.3826083 , ..., -86.0864703 ,
       -86.05714735, -86.43709451])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2ed1eedc-0b49-451c-857f-90a2e9df2170' class='xr-section-summary-in' type='checkbox'  ><label for='section-2ed1eedc-0b49-451c-857f-90a2e9df2170' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>index</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4fccddc7-f2de-4fd0-b6c7-eaf69528ab92' class='xr-index-data-in' type='checkbox'/><label for='index-4fccddc7-f2de-4fd0-b6c7-eaf69528ab92' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(RangeIndex(start=0, stop=1014, step=1, name=&#x27;index&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50b4ddd8-68cf-4c9c-b6d6-635be10b8d77' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-50b4ddd8-68cf-4c9c-b6d6-635be10b8d77' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for segmentation step:</span>
<span class="n">parameters_segmentation</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_segmentation</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;watershed&#39;</span>
<span class="n">parameters_segmentation</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">30</span> 
<span class="c1">#parameters_segmentation[&#39;features&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;field&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;dxy&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;target&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;level&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;max_distance&#39;]</span>
<span class="c1">#Maximum distance from a marker allowed to be classified as</span>
        <span class="c1">#belonging to that cell. Default is None.</span>
<span class="c1">#parameters_segmentation[&#39;vertical_coord&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Features_df=Features.to_dataframe()</span>

<span class="c1"># Perform Segmentation and save resulting mask to NetCDF file:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting segmentation based on reflectivity&#39;</span><span class="p">)</span>
<span class="n">Mask_iris</span><span class="p">,</span><span class="n">Features_Precip</span> <span class="o">=</span><span class="n">tobac</span><span class="o">.</span><span class="n">segmentation</span><span class="o">.</span><span class="n">segmentation</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span><span class="n">maxrefl_iris</span><span class="p">,</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_segmentation</span><span class="p">)</span>

<span class="n">Mask</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="o">.</span><span class="n">from_iris</span><span class="p">(</span><span class="n">Mask_iris</span><span class="p">)</span>
<span class="n">Mask</span> <span class="o">=</span> <span class="n">Mask</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="c1">#Mask,Features_Precip=segmentation(Features,maxrefl,dxy,**parameters_segmentation)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;segmentation based on reflectivity performed, start saving results to files&#39;</span><span class="p">)</span>
<span class="n">Mask</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Mask_Segmentation_refl.nc&#39;</span><span class="p">))</span>                
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting segmentation based on reflectivity
segmentation based on reflectivity performed, start saving results to files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for the linking step:</span>
<span class="n">parameters_linking</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;stubs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#5</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;method_linking&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;predict&#39;</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_stop&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.2</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_step&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#Order of polynomial for extrapolating</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;subnetwork_size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">100</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">3</span><span class="c1">#4</span>
<span class="c1">#parameters_linking[&#39;time_cell_min&#39;]=1</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.6</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;d_min&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">None</span> <span class="c1">#5 </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform trajectory linking using trackpy and save the resulting DataFrame:</span>

<span class="n">Track_df</span><span class="o">=</span><span class="n">tobac</span><span class="o">.</span><span class="n">linking_trackpy</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span><span class="n">Mask_iris</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">dxy</span><span class="o">=</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_linking</span><span class="p">)</span>

<span class="n">Track</span> <span class="o">=</span> <span class="n">Track_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>

<span class="n">Track</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Track.nc&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frame 24: 56 trajectories present.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/mambaforge/envs/ams-open-radar-2023-dev/lib/python3.10/site-packages/trackpy/predict.py:227: UserWarning: Could not generate velocity field for prediction: no tracks
  warn(&#39;Could not generate velocity field for prediction: no tracks&#39;)
/Users/mgrover/mambaforge/envs/ams-open-radar-2023-dev/lib/python3.10/site-packages/xarray/coding/times.py:618: RuntimeWarning: invalid value encountered in cast
  int_num = np.asarray(num, dtype=np.int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (index: 1014)
Coordinates:
  * index                    (index) int64 0 1 2 3 4 ... 1010 1011 1012 1013
Data variables: (12/13)
    frame                    (index) int64 0 0 0 0 0 0 0 ... 24 24 24 24 24 24
    idx                      (index) int64 1 2 3 4 6 7 8 ... 65 66 67 68 69 71
    hdim_1                   (index) float64 190.9 305.6 232.7 ... 467.1 536.8
    hdim_2                   (index) float64 217.4 132.7 187.5 ... 428.8 359.8
    num                      (index) int64 1079 9688 75 5 7 ... 223 12 15 37 7
    threshold_value          (index) int64 30 30 30 30 30 30 ... 30 30 30 30 30
    ...                       ...
    time                     (index) object 2008-04-11 18:12:23 ... 2008-04-1...
    timestr                  (index) object &#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-0...
    projection_y_coordinate  (index) float64 -5.438e+04 3.059e+03 ... 1.188e+05
    projection_x_coordinate  (index) float64 -4.111e+04 -8.352e+04 ... 3.019e+04
    latitude                 (index) float64 34.16 34.67 34.34 ... 35.4 35.71
    longitude                (index) float64 -87.22 -87.68 ... -86.06 -86.44</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7a9ebfbe-b330-4392-8432-98b284e7fe7f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7a9ebfbe-b330-4392-8432-98b284e7fe7f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>index</span>: 1014</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-25453346-a787-477b-a18c-9c8871399553' class='xr-section-summary-in' type='checkbox'  checked><label for='section-25453346-a787-477b-a18c-9c8871399553' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>index</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 1010 1011 1012 1013</div><input id='attrs-577a4a53-b90d-4107-ba4b-2d76a8dc8621' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-577a4a53-b90d-4107-ba4b-2d76a8dc8621' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13d5a8d6-71e6-4d45-97f9-27eb6fe540f5' class='xr-var-data-in' type='checkbox'><label for='data-13d5a8d6-71e6-4d45-97f9-27eb6fe540f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 1011, 1012, 1013])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1cf9a23c-6e37-4a4a-83e3-e9b9065af289' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1cf9a23c-6e37-4a4a-83e3-e9b9065af289' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frame</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 ... 24 24 24 24 24 24</div><input id='attrs-065e39e2-7195-4e3f-a0c1-c4deb4fba79a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-065e39e2-7195-4e3f-a0c1-c4deb4fba79a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ff060bf-9df5-4912-90a0-22da3db941f3' class='xr-var-data-in' type='checkbox'><label for='data-9ff060bf-9df5-4912-90a0-22da3db941f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  0,  0, ..., 24, 24, 24])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>idx</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 6 7 8 ... 65 66 67 68 69 71</div><input id='attrs-27e5ea63-a9d3-43e2-a0f4-8382cca80d95' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-27e5ea63-a9d3-43e2-a0f4-8382cca80d95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e39b8e61-2570-47eb-8478-3a1fa332e033' class='xr-var-data-in' type='checkbox'><label for='data-e39b8e61-2570-47eb-8478-3a1fa332e033' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3, ..., 68, 69, 71])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_1</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>190.9 305.6 232.7 ... 467.1 536.8</div><input id='attrs-8c7d908e-b937-4455-a586-aaa8b99fb155' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8c7d908e-b937-4455-a586-aaa8b99fb155' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa685399-cb9d-4abb-b4e5-2a37c14f255d' class='xr-var-data-in' type='checkbox'><label for='data-aa685399-cb9d-4abb-b4e5-2a37c14f255d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([190.92310225, 305.60827423, 232.65435517, ..., 458.50261951,
       467.11951224, 536.78037042])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_2</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>217.4 132.7 187.5 ... 428.8 359.8</div><input id='attrs-37d1e0fd-0ae9-4f4d-a529-74ef3c17b59e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-37d1e0fd-0ae9-4f4d-a529-74ef3c17b59e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54a5f539-a37c-4ee9-a3c5-0f0a1037abc1' class='xr-var-data-in' type='checkbox'><label for='data-54a5f539-a37c-4ee9-a3c5-0f0a1037abc1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([217.42111362, 132.73303546, 187.47522731, ..., 423.53552979,
       428.78326059, 359.78507397])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1079 9688 75 5 7 ... 223 12 15 37 7</div><input id='attrs-b37b2042-d7d3-46fb-90fe-7e0510f5a7a8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b37b2042-d7d3-46fb-90fe-7e0510f5a7a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0809976-970f-448f-8928-2939090a5516' class='xr-var-data-in' type='checkbox'><label for='data-f0809976-970f-448f-8928-2939090a5516' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1079, 9688,   75, ...,   15,   37,    7])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>threshold_value</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>30 30 30 30 30 ... 30 30 30 30 30</div><input id='attrs-adb04f77-9e47-4104-8ac4-efd05c752c65' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-adb04f77-9e47-4104-8ac4-efd05c752c65' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bb184bbb-8311-4d1f-8e39-64fd234b38b3' class='xr-var-data-in' type='checkbox'><label for='data-bb184bbb-8311-4d1f-8e39-64fd234b38b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([30, 30, 30, ..., 30, 30, 30])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 ... 1011 1012 1013 1014</div><input id='attrs-a9eb1a7a-ef4a-47cf-914c-201dd4485eab' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a9eb1a7a-ef4a-47cf-914c-201dd4485eab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1357f9d-2267-4c50-b53f-765ff5be7fa6' class='xr-var-data-in' type='checkbox'><label for='data-d1357f9d-2267-4c50-b53f-765ff5be7fa6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   1,    2,    3, ..., 1012, 1013, 1014])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2008-04-11 18:12:23 ... 2008-04-...</div><input id='attrs-ba8cf232-f94c-4829-80c6-a77b60115e83' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ba8cf232-f94c-4829-80c6-a77b60115e83' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3a7bdb3-5cbb-4e40-840d-1cec8cb7ae96' class='xr-var-data-in' type='checkbox'><label for='data-d3a7bdb3-5cbb-4e40-840d-1cec8cb7ae96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       ...,
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>timestr</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-...</div><input id='attrs-47b9e277-e551-4cca-9269-4df2ec38bc9d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-47b9e277-e551-4cca-9269-4df2ec38bc9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95dc258d-1e9e-459e-939c-1f2feefd519f' class='xr-var-data-in' type='checkbox'><label for='data-95dc258d-1e9e-459e-939c-1f2feefd519f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11 18:12:23&#x27;, &#x27;2008-04-11 18:12:23&#x27;,
       &#x27;2008-04-11 18:12:23&#x27;, ..., &#x27;2008-04-11 20:20:58&#x27;,
       &#x27;2008-04-11 20:20:58&#x27;, &#x27;2008-04-11 20:20:58&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_y_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.438e+04 3.059e+03 ... 1.188e+05</div><input id='attrs-5960e562-a8d1-4ed9-87d4-c52e2b226b9d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5960e562-a8d1-4ed9-87d4-c52e2b226b9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aacf5de0-6a51-4270-b56d-ec90975bd01a' class='xr-var-data-in' type='checkbox'><label for='data-aacf5de0-6a51-4270-b56d-ec90975bd01a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-54379.08067544,   3059.23584341, -33478.62011565, ...,
        79634.03314329,  83949.6722385 , 118838.24895707])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_x_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-4.111e+04 -8.352e+04 ... 3.019e+04</div><input id='attrs-ec7a275c-f873-48a5-922c-6a769dc4537c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec7a275c-f873-48a5-922c-6a769dc4537c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6682486-0165-48cb-a9a7-ceaafa554b82' class='xr-var-data-in' type='checkbox'><label for='data-d6682486-0165-48cb-a9a7-ceaafa554b82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-41107.95644928, -83522.68674834, -56105.89617347, ...,
        62121.30039404,  64749.54620303,  30192.8584164 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>34.16 34.67 34.34 ... 35.4 35.71</div><input id='attrs-722db7d3-b709-40c3-b0ec-a9c4785872fe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-722db7d3-b709-40c3-b0ec-a9c4785872fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0138fb3b-a7a3-4be6-a828-04438b76c725' class='xr-var-data-in' type='checkbox'><label for='data-0138fb3b-a7a3-4be6-a828-04438b76c725' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([34.15634087, 34.67030806, 34.34359344, ..., 35.36045623,
       35.39910102, 35.71448396])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.22 -87.68 ... -86.06 -86.44</div><input id='attrs-5a5b914c-eb35-46dd-89ad-286b531d8a4c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a5b914c-eb35-46dd-89ad-286b531d8a4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d16e7dc8-7783-49d3-aeb9-b1b63366cc77' class='xr-var-data-in' type='checkbox'><label for='data-d16e7dc8-7783-49d3-aeb9-b1b63366cc77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-87.21825008, -87.68481782, -87.3826083 , ..., -86.0864703 ,
       -86.05714735, -86.43709451])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-97bc8f99-2653-42a8-9f98-afbdab80c290' class='xr-section-summary-in' type='checkbox'  ><label for='section-97bc8f99-2653-42a8-9f98-afbdab80c290' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>index</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e4396ca3-9380-4f12-8e3c-3c483c22f3ff' class='xr-index-data-in' type='checkbox'/><label for='index-e4396ca3-9380-4f12-8e3c-3c483c22f3ff' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(RangeIndex(start=0, stop=1014, step=1, name=&#x27;index&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d337ae98-a508-4935-b625-e47326fc9aea' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d337ae98-a508-4935-b625-e47326fc9aea' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">merge_split</span><span class="o">.</span><span class="n">merge_split_MEST</span><span class="p">(</span><span class="n">Track_df</span><span class="p">,</span><span class="mf">500.</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">25000.0</span><span class="p">)</span>

<span class="n">Track</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Track.nc&quot;</span><span class="p">)</span>
<span class="c1"># ds = tobac.utils.standardize_track_dataset(Track, refl_mask)#, data[&#39;ProjectionCoordinateSystem&#39;])</span>
<span class="c1"># both_ds = xarray.merge([ds, d],compat =&#39;override&#39;)</span>

<span class="c1"># both_ds = tobac.utils.compress_all(both_ds)</span>
<span class="c1"># both_ds.to_netcdf(os.path.join(savedir,&#39;Track_features_merges.nc&#39;))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                   (track: 1, cell: 1, feature: 1014)
Coordinates:
  * track                     (track) float64 0.0
  * cell                      (cell) int64 -1
  * feature                   (feature) int64 1 2 3 4 5 ... 1011 1012 1013 1014
Data variables:
    cell_parent_track_id      (cell) float64 0.0
    feature_parent_cell_id    (feature) int64 -1 -1 -1 -1 -1 ... -1 -1 -1 -1 -1
    feature_parent_track_id   (feature) float64 -1.0 -1.0 -1.0 ... -1.0 -1.0
    track_child_cell_count    (track) float64 1.0
    cell_child_feature_count  (cell) float64 1.014e+03</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1ed6e037-ad34-479e-8c70-0f11896f4cb0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1ed6e037-ad34-479e-8c70-0f11896f4cb0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>track</span>: 1</li><li><span class='xr-has-index'>cell</span>: 1</li><li><span class='xr-has-index'>feature</span>: 1014</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8b1c1979-8a66-455f-80b5-d9608af36f4e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8b1c1979-8a66-455f-80b5-d9608af36f4e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>track</span></div><div class='xr-var-dims'>(track)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-a4f8a93c-895a-4c6c-9bd7-f0be3ca2f1ab' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4f8a93c-895a-4c6c-9bd7-f0be3ca2f1ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c706b82-9952-45f9-86fd-cefe0247f5ed' class='xr-var-data-in' type='checkbox'><label for='data-0c706b82-9952-45f9-86fd-cefe0247f5ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>cell</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-1</div><input id='attrs-bd8f187b-4952-4d46-a9bb-9581a5db9a10' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bd8f187b-4952-4d46-a9bb-9581a5db9a10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3098f4e-61b7-4fd4-8e53-ef07ff0be3b7' class='xr-var-data-in' type='checkbox'><label for='data-a3098f4e-61b7-4fd4-8e53-ef07ff0be3b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>feature</span></div><div class='xr-var-dims'>(feature)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 ... 1011 1012 1013 1014</div><input id='attrs-f346ef3b-ee6d-469c-9325-87deabefae5d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f346ef3b-ee6d-469c-9325-87deabefae5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7b27348-c2cf-40fc-8460-fd15f55d1135' class='xr-var-data-in' type='checkbox'><label for='data-a7b27348-c2cf-40fc-8460-fd15f55d1135' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   1,    2,    3, ..., 1012, 1013, 1014])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7e97e823-4197-4dcf-b329-5c44d36738f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7e97e823-4197-4dcf-b329-5c44d36738f1' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>cell_parent_track_id</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-ccc7ae7e-e3fd-4787-93be-eaa925675e13' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ccc7ae7e-e3fd-4787-93be-eaa925675e13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e0eb555-a1d5-4354-a431-4b1a9171e13d' class='xr-var-data-in' type='checkbox'><label for='data-4e0eb555-a1d5-4354-a431-4b1a9171e13d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature_parent_cell_id</span></div><div class='xr-var-dims'>(feature)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-1 -1 -1 -1 -1 ... -1 -1 -1 -1 -1</div><input id='attrs-ba85964a-e946-4057-a5c5-73dfa53a4974' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ba85964a-e946-4057-a5c5-73dfa53a4974' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-321a586a-d1b2-4f3b-bd48-b854b66f34a8' class='xr-var-data-in' type='checkbox'><label for='data-321a586a-d1b2-4f3b-bd48-b854b66f34a8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1, -1, -1, ..., -1, -1, -1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature_parent_track_id</span></div><div class='xr-var-dims'>(feature)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -1.0 -1.0 ... -1.0 -1.0 -1.0</div><input id='attrs-719acabf-1243-4ca6-bbe3-2315045d6b4c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-719acabf-1243-4ca6-bbe3-2315045d6b4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-418b9a22-0c66-42a8-9e99-2438e53bd91f' class='xr-var-data-in' type='checkbox'><label for='data-418b9a22-0c66-42a8-9e99-2438e53bd91f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1., -1., -1., ..., -1., -1., -1.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>track_child_cell_count</span></div><div class='xr-var-dims'>(track)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-eabd25b9-b620-4c34-af52-f7f51b65b569' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eabd25b9-b620-4c34-af52-f7f51b65b569' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-acc4b180-cd64-45cf-9459-c84a4d936522' class='xr-var-data-in' type='checkbox'><label for='data-acc4b180-cd64-45cf-9459-c84a4d936522' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cell_child_feature_count</span></div><div class='xr-var-dims'>(cell)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.014e+03</div><input id='attrs-04cca8aa-f5f3-492b-a953-933ca9a1c93a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04cca8aa-f5f3-492b-a953-933ca9a1c93a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18d6b361-f540-4b9d-894d-71c80d52cf8a' class='xr-var-data-in' type='checkbox'><label for='data-18d6b361-f540-4b9d-894d-71c80d52cf8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1014.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-91c649b5-5c2c-4b80-a793-15cc8f02a553' class='xr-section-summary-in' type='checkbox'  ><label for='section-91c649b5-5c2c-4b80-a793-15cc8f02a553' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>track</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f29f1c61-4377-443b-99cf-d7542d465114' class='xr-index-data-in' type='checkbox'/><label for='index-f29f1c61-4377-443b-99cf-d7542d465114' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([0.0], dtype=&#x27;float64&#x27;, name=&#x27;track&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>cell</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f23fa5c8-4cd9-4651-b2a8-92098febd30d' class='xr-index-data-in' type='checkbox'/><label for='index-f23fa5c8-4cd9-4651-b2a8-92098febd30d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([-1], dtype=&#x27;int64&#x27;, name=&#x27;cell&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>feature</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1d0afd34-bd01-4422-a8a2-6fb023ffb37e' class='xr-index-data-in' type='checkbox'/><label for='index-1d0afd34-bd01-4422-a8a2-6fb023ffb37e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([   1,    2,    3,    4,    5,    6,    7,    8,    9,   10,
            ...
            1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014],
           dtype=&#x27;int64&#x27;, name=&#x27;feature&#x27;, length=1014))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-80b3f0a7-87be-49e8-95e8-f4212282e868' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-80b3f0a7-87be-49e8-95e8-f4212282e868' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Track</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Track.nc&quot;</span><span class="p">)</span>
<span class="n">Features</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Features.nc&quot;</span><span class="p">)</span>
<span class="n">refl_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Mask_Segmentation_refl.nc&quot;</span><span class="p">)</span>

<span class="c1"># both_ds = xarray.open_dataset(savedir+&#39;/Track_features_merges.nc&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (index: 1014)
Coordinates:
  * index                    (index) int64 0 1 2 3 4 ... 1010 1011 1012 1013
Data variables: (12/13)
    frame                    (index) int64 ...
    idx                      (index) int64 ...
    hdim_1                   (index) float64 ...
    hdim_2                   (index) float64 ...
    num                      (index) int64 ...
    threshold_value          (index) int64 ...
    ...                       ...
    time                     (index) datetime64[ns] ...
    timestr                  (index) object ...
    projection_y_coordinate  (index) float64 ...
    projection_x_coordinate  (index) float64 ...
    latitude                 (index) float64 ...
    longitude                (index) float64 ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-57194e57-85e5-429f-8610-b0e08f325d73' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-57194e57-85e5-429f-8610-b0e08f325d73' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>index</span>: 1014</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e087e097-f6e8-495a-ae50-3f05a5141184' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e087e097-f6e8-495a-ae50-3f05a5141184' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>index</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 1010 1011 1012 1013</div><input id='attrs-5c14f77a-7f75-4db2-8e82-b08c8df24081' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5c14f77a-7f75-4db2-8e82-b08c8df24081' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e647a738-b93a-4bcd-9013-b18f03ed3229' class='xr-var-data-in' type='checkbox'><label for='data-e647a738-b93a-4bcd-9013-b18f03ed3229' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 1011, 1012, 1013])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e6aa2b73-04b5-4b25-a4aa-4a11bd06874d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6aa2b73-04b5-4b25-a4aa-4a11bd06874d' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frame</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-624f9d59-f74f-48bd-a5b7-c8e7ba0ab89c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-624f9d59-f74f-48bd-a5b7-c8e7ba0ab89c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-615fedca-6495-4528-89ad-da32db091a82' class='xr-var-data-in' type='checkbox'><label for='data-615fedca-6495-4528-89ad-da32db091a82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>idx</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5e252a89-7a04-4e07-97cb-f6dd630075ae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5e252a89-7a04-4e07-97cb-f6dd630075ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6820865e-cefe-4ec0-9b6d-1158d55be967' class='xr-var-data-in' type='checkbox'><label for='data-6820865e-cefe-4ec0-9b6d-1158d55be967' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_1</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a4a10898-9a35-44da-88dd-d8d833417b99' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4a10898-9a35-44da-88dd-d8d833417b99' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b94155e-c274-4b74-8ab1-b3cc2cc435a6' class='xr-var-data-in' type='checkbox'><label for='data-8b94155e-c274-4b74-8ab1-b3cc2cc435a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_2</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-86e00956-da1b-4831-a5ec-2db76bd03014' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-86e00956-da1b-4831-a5ec-2db76bd03014' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6974bc79-f253-4ecb-9f27-81feb19b8e3c' class='xr-var-data-in' type='checkbox'><label for='data-6974bc79-f253-4ecb-9f27-81feb19b8e3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bd03ec86-7413-4865-b74a-14bff01b8c42' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bd03ec86-7413-4865-b74a-14bff01b8c42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20cef06f-f40a-4544-ab44-9a523b7a06b9' class='xr-var-data-in' type='checkbox'><label for='data-20cef06f-f40a-4544-ab44-9a523b7a06b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>threshold_value</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-949a9365-d068-48b4-a2bf-5f6fdcedc8a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-949a9365-d068-48b4-a2bf-5f6fdcedc8a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4525bc16-cf7f-4dbf-b8c9-aa12c973825b' class='xr-var-data-in' type='checkbox'><label for='data-4525bc16-cf7f-4dbf-b8c9-aa12c973825b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2f1c157b-c01f-4369-9714-03fec1964eca' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2f1c157b-c01f-4369-9714-03fec1964eca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc4c14db-8d02-4abf-a896-d9d56a6c38c5' class='xr-var-data-in' type='checkbox'><label for='data-fc4c14db-8d02-4abf-a896-d9d56a6c38c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-528f45db-48b0-4a49-abe9-92a1318b9be0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-528f45db-48b0-4a49-abe9-92a1318b9be0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7f340fc5-4a99-4f79-ab96-647231981b15' class='xr-var-data-in' type='checkbox'><label for='data-7f340fc5-4a99-4f79-ab96-647231981b15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>timestr</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bb56e837-0046-4d88-8d91-57787b419f43' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bb56e837-0046-4d88-8d91-57787b419f43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c47d9163-718f-4630-a25b-25db29c3e7b2' class='xr-var-data-in' type='checkbox'><label for='data-c47d9163-718f-4630-a25b-25db29c3e7b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_y_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-654da7cf-231f-4556-b5f1-0b281ef1cb57' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-654da7cf-231f-4556-b5f1-0b281ef1cb57' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c19afd4a-8660-41de-bc10-88f60cf961b4' class='xr-var-data-in' type='checkbox'><label for='data-c19afd4a-8660-41de-bc10-88f60cf961b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_x_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7ab61907-af16-41d6-b09f-ce746e7ebf24' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ab61907-af16-41d6-b09f-ce746e7ebf24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c079530b-cbef-4e30-9113-fc1f488a8124' class='xr-var-data-in' type='checkbox'><label for='data-c079530b-cbef-4e30-9113-fc1f488a8124' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6194599b-5c9a-4634-87b0-5f1e859dd5dc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6194599b-5c9a-4634-87b0-5f1e859dd5dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1fa5dd68-1e9f-4db3-8da1-1d68ad1d1981' class='xr-var-data-in' type='checkbox'><label for='data-1fa5dd68-1e9f-4db3-8da1-1d68ad1d1981' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-171959c8-0713-4615-a36b-1c3134ec3f94' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-171959c8-0713-4615-a36b-1c3134ec3f94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-244adc98-dfbd-4a13-8287-27ba75890ea9' class='xr-var-data-in' type='checkbox'><label for='data-244adc98-dfbd-4a13-8287-27ba75890ea9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1014 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-14f78966-b60e-4da0-a6e8-1439397afa74' class='xr-section-summary-in' type='checkbox'  ><label for='section-14f78966-b60e-4da0-a6e8-1439397afa74' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>index</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6c7284f1-09c0-4b58-8e9b-56cefe7250e6' class='xr-index-data-in' type='checkbox'/><label for='index-6c7284f1-09c0-4b58-8e9b-56cefe7250e6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
            ...
            1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013],
           dtype=&#x27;int64&#x27;, name=&#x27;index&#x27;, length=1014))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50d68805-3505-498b-83d2-ba1e143822bd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-50d68805-3505-498b-83d2-ba1e143822bd' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">isolated_min</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">show_tracks</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ref_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">refl</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="p">[</span><span class="n">frame</span><span class="p">,:,:]</span> 
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    
<span class="n">refplt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">refl</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="n">levels</span> <span class="o">=</span> <span class="n">ref_levels</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_LangRainbow12&#39;</span><span class="p">,</span><span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">24</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span><span class="c1">#,extent = [0,-10000,-20000,-10000])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">refplt</span><span class="p">,</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Mask</span><span class="p">[</span><span class="s1">&#39;segmentation_mask&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">x_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">imcell2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
    


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="c1">#print(i)</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">cell_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;feature_parent_cell_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">frame</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">frame</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">],</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
 





<span class="c1">#     fig.savefig(plot_dir+&#39;/&#39;+&#39;20260331_track_&#39;+str(frame)+&#39;.png&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3516ac36bcd0a0ef24a88a1bb44faee1f48037837c939172fa5a000608a2e622.png" src="../../_images/3516ac36bcd0a0ef24a88a1bb44faee1f48037837c939172fa5a000608a2e622.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">isolated_min</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">show_tracks</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ref_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">refl</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="p">[</span><span class="n">frame</span><span class="p">,:,:]</span> 
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    
<span class="n">refplt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">refl</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="n">levels</span> <span class="o">=</span> <span class="n">ref_levels</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_LangRainbow12&#39;</span><span class="p">,</span><span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">24</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span><span class="c1">#,extent = [0,-10000,-20000,-10000])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">refplt</span><span class="p">,</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Mask</span><span class="p">[</span><span class="s1">&#39;segmentation_mask&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">x_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">imcell2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
    



<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]:</span>
    <span class="n">track_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;cell_parent_track_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">][</span><span class="n">track_i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">feature_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;feature_parent_cell_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">frame</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">frame</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">])):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">],</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>





<span class="c1">#     fig.savefig(plot_dir+&#39;/&#39;+&#39;20260331_track_&#39;+str(frame)+&#39;.png&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3516ac36bcd0a0ef24a88a1bb44faee1f48037837c939172fa5a000608a2e622.png" src="../../_images/3516ac36bcd0a0ef24a88a1bb44faee1f48037837c939172fa5a000608a2e622.png" />
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="multiple-thresholds">
<h1>Multiple Thresholds<a class="headerlink" href="#multiple-thresholds" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr_grid_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;reflectivity&#x27; (time: 25, z: 30, y: 600, x: 600)&gt;
dask.array&lt;concatenate, shape=(25, 30, 600, 600), dtype=float32, chunksize=(1, 30, 600, 600), chunktype=numpy.ndarray&gt;
Coordinates:
  * time     (time) datetime64[ns] 2008-04-11T18:12:23 ... 2008-04-11T20:20:58
  * z        (z) float64 0.0 517.2 1.034e+03 ... 1.397e+04 1.448e+04 1.5e+04
    lat      (y, x) float64 dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;
    lon      (y, x) float64 dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;
  * y        (y) float64 -1.5e+05 -1.495e+05 -1.49e+05 ... 1.495e+05 1.5e+05
  * x        (x) float64 -1.5e+05 -1.495e+05 -1.49e+05 ... 1.495e+05 1.5e+05
Attributes:
    units:          dBZ
    standard_name:  equivalent_reflectivity_factor
    long_name:      Reflectivity
    coordinates:    elevation azimuth range</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'reflectivity'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 25</li><li><span class='xr-has-index'>z</span>: 30</li><li><span class='xr-has-index'>y</span>: 600</li><li><span class='xr-has-index'>x</span>: 600</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-14ab6623-8dad-4294-8529-77a8010bc201' class='xr-array-in' type='checkbox' checked><label for='section-14ab6623-8dad-4294-8529-77a8010bc201' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 30, 600, 600), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.01 GiB </td>
                        <td> 41.20 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (25, 30, 600, 600) </td>
                        <td> (1, 30, 600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 25 chunks in 51 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="396" height="190" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="33" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="33" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="1" y1="0" x2="1" y2="25" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="4" y1="0" x2="4" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="6" y1="0" x2="6" y2="25" />
  <line x1="8" y1="0" x2="8" y2="25" />
  <line x1="9" y1="0" x2="9" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="13" y1="0" x2="13" y2="25" />
  <line x1="14" y1="0" x2="14" y2="25" />
  <line x1="16" y1="0" x2="16" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="18" y1="0" x2="18" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="21" y1="0" x2="21" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="24" y1="0" x2="24" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" />
  <line x1="26" y1="0" x2="26" y2="25" />
  <line x1="28" y1="0" x2="28" y2="25" />
  <line x1="29" y1="0" x2="29" y2="25" />
  <line x1="30" y1="0" x2="30" y2="25" />
  <line x1="32" y1="0" x2="32" y2="25" />
  <line x1="33" y1="0" x2="33" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 33.38369844152673,0.0 33.38369844152673,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="16.691849" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >25</text>
  <text x="53.383698" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,53.383698,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="103" y1="120" x2="123" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="103" y2="120" style="stroke-width:2" />
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 123.29471539635256,20.294715396352554 123.29471539635256,140.29471539635256 103.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="103" y1="0" x2="223" y2="0" style="stroke-width:2" />
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="103" y1="0" x2="123" y2="20" style="stroke-width:2" />
  <line x1="223" y1="0" x2="243" y2="20" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="103.0,0.0 223.0,0.0 243.29471539635256,20.294715396352554 123.29471539635256,20.294715396352554" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="123" y1="20" x2="243" y2="20" style="stroke-width:2" />
  <line x1="123" y1="140" x2="243" y2="140" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="123" y1="20" x2="123" y2="140" style="stroke-width:2" />
  <line x1="243" y1="20" x2="243" y2="140" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="123.29471539635256,20.294715396352554 243.29471539635256,20.294715396352554 243.29471539635256,140.29471539635256 123.29471539635256,140.29471539635256" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="183.294715" y="160.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="263.294715" y="80.294715" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,263.294715,80.294715)">600</text>
  <text x="103.147358" y="150.147358" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,103.147358,150.147358)">30</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-7a31e812-9d4f-4278-b2b7-8b73ef006107' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7a31e812-9d4f-4278-b2b7-8b73ef006107' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2008-04-11T18:12:23 ... 2008-04-...</div><input id='attrs-a237094a-2632-4ff5-9fc5-e58f71bee8ed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a237094a-2632-4ff5-9fc5-e58f71bee8ed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bb2c5cb-4c0e-497a-b470-f4ff0ee7c101' class='xr-var-data-in' type='checkbox'><label for='data-4bb2c5cb-4c0e-497a-b470-f4ff0ee7c101' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11T18:12:23.000000000&#x27;, &#x27;2008-04-11T18:17:23.000000000&#x27;,
       &#x27;2008-04-11T18:22:42.000000000&#x27;, &#x27;2008-04-11T18:27:41.000000000&#x27;,
       &#x27;2008-04-11T18:33:08.000000000&#x27;, &#x27;2008-04-11T18:38:35.000000000&#x27;,
       &#x27;2008-04-11T18:44:18.000000000&#x27;, &#x27;2008-04-11T18:49:44.000000000&#x27;,
       &#x27;2008-04-11T18:55:11.000000000&#x27;, &#x27;2008-04-11T19:00:23.000000000&#x27;,
       &#x27;2008-04-11T19:05:35.000000000&#x27;, &#x27;2008-04-11T19:10:47.000000000&#x27;,
       &#x27;2008-04-11T19:15:59.000000000&#x27;, &#x27;2008-04-11T19:21:11.000000000&#x27;,
       &#x27;2008-04-11T19:26:22.000000000&#x27;, &#x27;2008-04-11T19:31:35.000000000&#x27;,
       &#x27;2008-04-11T19:36:46.000000000&#x27;, &#x27;2008-04-11T19:41:59.000000000&#x27;,
       &#x27;2008-04-11T19:47:10.000000000&#x27;, &#x27;2008-04-11T19:52:22.000000000&#x27;,
       &#x27;2008-04-11T19:57:34.000000000&#x27;, &#x27;2008-04-11T20:04:21.000000000&#x27;,
       &#x27;2008-04-11T20:09:49.000000000&#x27;, &#x27;2008-04-11T20:15:30.000000000&#x27;,
       &#x27;2008-04-11T20:20:58.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>z</span></div><div class='xr-var-dims'>(z)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 517.2 ... 1.448e+04 1.5e+04</div><input id='attrs-7e97a186-5770-4ad7-8435-b4f98aaa383c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7e97a186-5770-4ad7-8435-b4f98aaa383c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-874932ff-dc54-4c75-92d3-26f03a0c2732' class='xr-var-data-in' type='checkbox'><label for='data-874932ff-dc54-4c75-92d3-26f03a0c2732' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>altitude</dd><dt><span>long_name :</span></dt><dd>Z distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>array([    0.      ,   517.241379,  1034.482759,  1551.724138,  2068.965517,
        2586.206897,  3103.448276,  3620.689655,  4137.931034,  4655.172414,
        5172.413793,  5689.655172,  6206.896552,  6724.137931,  7241.37931 ,
        7758.62069 ,  8275.862069,  8793.103448,  9310.344828,  9827.586207,
       10344.827586, 10862.068966, 11379.310345, 11896.551724, 12413.793103,
       12931.034483, 13448.275862, 13965.517241, 14482.758621, 15000.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;</div><input id='attrs-1bb30bbb-318d-4006-ab6e-f385ff1543ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1bb30bbb-318d-4006-ab6e-f385ff1543ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b74b192-ef9c-4d9f-8fc3-5a79d00d943f' class='xr-var-data-in' type='checkbox'><label for='data-3b74b192-ef9c-4d9f-8fc3-5a79d00d943f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_N</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.75 MiB </td>
                        <td> 2.75 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (600, 600) </td>
                        <td> (600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 120 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="120" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="140.000000" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,60.000000)">600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 600), meta=np.ndarray&gt;</div><input id='attrs-badfbe90-fc80-4d6d-9b1c-ef5682e2dfab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-badfbe90-fc80-4d6d-9b1c-ef5682e2dfab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff81ed2d-5c15-4ebd-a842-b2ef5f275d8f' class='xr-var-data-in' type='checkbox'><label for='data-ff81ed2d-5c15-4ebd-a842-b2ef5f275d8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_E</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.75 MiB </td>
                        <td> 2.75 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (600, 600) </td>
                        <td> (600, 600) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 120 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="170" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="120" x2="120" y2="120" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="120" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="120" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,120.0 0.0,120.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="140.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" >600</text>
  <text x="140.000000" y="60.000000" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,60.000000)">600</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-d99f2287-26dd-4b2d-a043-48dc616d4611' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d99f2287-26dd-4b2d-a043-48dc616d4611' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f62c3e0a-3e24-49bb-94bf-addd734a5ec6' class='xr-var-data-in' type='checkbox'><label for='data-f62c3e0a-3e24-49bb-94bf-addd734a5ec6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>long_name :</span></dt><dd>Y distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000.      , -149499.165275, -148998.330551, ...,  148998.330551,
        149499.165275,  150000.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-723365aa-0c40-494b-a147-57f430a86511' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-723365aa-0c40-494b-a147-57f430a86511' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-370dca7a-20a6-459f-b276-6aed0fa6e815' class='xr-var-data-in' type='checkbox'><label for='data-370dca7a-20a6-459f-b276-6aed0fa6e815' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>long_name :</span></dt><dd>X distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000.      , -149499.165275, -148998.330551, ...,  148998.330551,
        149499.165275,  150000.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9c59e3c5-30b9-4f61-b140-46d38915ef1e' class='xr-section-summary-in' type='checkbox'  ><label for='section-9c59e3c5-30b9-4f61-b140-46d38915ef1e' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bc6b0365-9b11-41cd-92cf-c613b28ba0a5' class='xr-index-data-in' type='checkbox'/><label for='index-bc6b0365-9b11-41cd-92cf-c613b28ba0a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2008-04-11 18:12:23&#x27;, &#x27;2008-04-11 18:17:23&#x27;,
               &#x27;2008-04-11 18:22:42&#x27;, &#x27;2008-04-11 18:27:41&#x27;,
               &#x27;2008-04-11 18:33:08&#x27;, &#x27;2008-04-11 18:38:35&#x27;,
               &#x27;2008-04-11 18:44:18&#x27;, &#x27;2008-04-11 18:49:44&#x27;,
               &#x27;2008-04-11 18:55:11&#x27;, &#x27;2008-04-11 19:00:23&#x27;,
               &#x27;2008-04-11 19:05:35&#x27;, &#x27;2008-04-11 19:10:47&#x27;,
               &#x27;2008-04-11 19:15:59&#x27;, &#x27;2008-04-11 19:21:11&#x27;,
               &#x27;2008-04-11 19:26:22&#x27;, &#x27;2008-04-11 19:31:35&#x27;,
               &#x27;2008-04-11 19:36:46&#x27;, &#x27;2008-04-11 19:41:59&#x27;,
               &#x27;2008-04-11 19:47:10&#x27;, &#x27;2008-04-11 19:52:22&#x27;,
               &#x27;2008-04-11 19:57:34&#x27;, &#x27;2008-04-11 20:04:21&#x27;,
               &#x27;2008-04-11 20:09:49&#x27;, &#x27;2008-04-11 20:15:30&#x27;,
               &#x27;2008-04-11 20:20:58&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>z</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-45833ef9-34cc-454f-bfba-4d8b8993da8c' class='xr-index-data-in' type='checkbox'/><label for='index-45833ef9-34cc-454f-bfba-4d8b8993da8c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([               0.0,  517.2413793103449, 1034.4827586206898,
              1551.7241379310346, 2068.9655172413795, 2586.2068965517246,
              3103.4482758620693,  3620.689655172414,  4137.931034482759,
               4655.172413793104,  5172.413793103449, 5689.6551724137935,
               6206.896551724139,  6724.137931034484,  7241.379310344828,
               7758.620689655173,  8275.862068965518,  8793.103448275862,
               9310.344827586208,  9827.586206896553, 10344.827586206899,
              10862.068965517243, 11379.310344827587, 11896.551724137933,
              12413.793103448277, 12931.034482758621, 13448.275862068967,
              13965.517241379312, 14482.758620689656,            15000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;z&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-467214bf-b8e5-4192-8291-a52a89e5891b' class='xr-index-data-in' type='checkbox'/><label for='index-467214bf-b8e5-4192-8291-a52a89e5891b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([          -150000.0,  -149499.1652754591,  -148998.3305509182,
               -148497.4958263773,  -147996.6611018364, -147495.82637729548,
               -146994.9916527546,  -146494.1569282137, -145993.32220367278,
              -145492.48747913187,
              ...
                145492.4874791319,  145993.32220367278,  146494.15692821366,
                146994.9916527546,  147495.82637729548,  147996.66110183642,
                148497.4958263773,  148998.33055091818,  149499.16527545912,
                         150000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=600))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c2a2cf75-c886-47f6-a728-e6edc918a7b5' class='xr-index-data-in' type='checkbox'/><label for='index-c2a2cf75-c886-47f6-a728-e6edc918a7b5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([          -150000.0,  -149499.1652754591,  -148998.3305509182,
               -148497.4958263773,  -147996.6611018364, -147495.82637729548,
               -146994.9916527546,  -146494.1569282137, -145993.32220367278,
              -145492.48747913187,
              ...
                145492.4874791319,  145993.32220367278,  146494.15692821366,
                146994.9916527546,  147495.82637729548,  147996.66110183642,
                148497.4958263773,  148998.33055091818,  149499.16527545912,
                         150000.0],
             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=600))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0a2b9fa2-ce7e-4d5f-8010-cd7660bb8b30' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0a2b9fa2-ce7e-4d5f-8010-cd7660bb8b30' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>coordinates :</span></dt><dd>elevation azimuth range</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">maxrefl_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="c1"># Features.to_netcdf(os.path.join(savedir,&#39;Features.nc&#39;))</span>
<span class="c1"># print(&#39;features saved&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting feature detection based on multiple thresholds
feature detection done
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame</th>
      <th>idx</th>
      <th>hdim_1</th>
      <th>hdim_2</th>
      <th>num</th>
      <th>threshold_value</th>
      <th>feature</th>
      <th>time</th>
      <th>timestr</th>
      <th>projection_y_coordinate</th>
      <th>projection_x_coordinate</th>
      <th>latitude</th>
      <th>longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>232.654355</td>
      <td>187.475227</td>
      <td>75</td>
      <td>30</td>
      <td>1</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-33478.620116</td>
      <td>-56105.896173</td>
      <td>34.343593</td>
      <td>-87.382608</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>4</td>
      <td>256.679129</td>
      <td>59.120160</td>
      <td>5</td>
      <td>30</td>
      <td>2</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-21446.178957</td>
      <td>-120390.570710</td>
      <td>34.446289</td>
      <td>-88.084443</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>6</td>
      <td>271.000000</td>
      <td>227.817852</td>
      <td>7</td>
      <td>30</td>
      <td>3</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-14273.789649</td>
      <td>-35900.909033</td>
      <td>34.517206</td>
      <td>-87.163348</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>8</td>
      <td>291.189565</td>
      <td>62.745582</td>
      <td>5</td>
      <td>30</td>
      <td>4</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-4162.154494</td>
      <td>-118574.833957</td>
      <td>34.601917</td>
      <td>-88.067061</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>9</td>
      <td>324.167350</td>
      <td>103.064594</td>
      <td>111</td>
      <td>30</td>
      <td>5</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>12354.265509</td>
      <td>-98381.672359</td>
      <td>34.752573</td>
      <td>-87.848376</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1494</th>
      <td>24</td>
      <td>121</td>
      <td>181.281622</td>
      <td>275.366252</td>
      <td>88</td>
      <td>50</td>
      <td>1495</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>-59207.868610</td>
      <td>-12087.018954</td>
      <td>34.113660</td>
      <td>-86.902791</td>
    </tr>
    <tr>
      <th>1495</th>
      <td>24</td>
      <td>122</td>
      <td>197.820473</td>
      <td>325.438786</td>
      <td>10</td>
      <td>50</td>
      <td>1496</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>-50924.637719</td>
      <td>12991.044798</td>
      <td>34.188142</td>
      <td>-86.630264</td>
    </tr>
    <tr>
      <th>1496</th>
      <td>24</td>
      <td>124</td>
      <td>306.319990</td>
      <td>384.751210</td>
      <td>88</td>
      <td>50</td>
      <td>1497</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>3415.687706</td>
      <td>42696.766189</td>
      <td>34.676028</td>
      <td>-86.304585</td>
    </tr>
    <tr>
      <th>1497</th>
      <td>24</td>
      <td>125</td>
      <td>303.064874</td>
      <td>488.028903</td>
      <td>71</td>
      <td>50</td>
      <td>1498</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>1785.412871</td>
      <td>94421.821376</td>
      <td>34.657907</td>
      <td>-85.739151</td>
    </tr>
    <tr>
      <th>1498</th>
      <td>24</td>
      <td>126</td>
      <td>333.334980</td>
      <td>385.977828</td>
      <td>21</td>
      <td>50</td>
      <td>1499</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>16945.733057</td>
      <td>43311.099281</td>
      <td>34.797679</td>
      <td>-86.297169</td>
    </tr>
  </tbody>
</table>
<p>1499 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (index: 1499)
Coordinates:
  * index                    (index) int64 0 1 2 3 4 ... 1495 1496 1497 1498
Data variables: (12/13)
    frame                    (index) int64 0 0 0 0 0 0 0 ... 24 24 24 24 24 24
    idx                      (index) int64 3 4 6 8 9 12 ... 121 122 124 125 126
    hdim_1                   (index) float64 232.7 256.7 271.0 ... 303.1 333.3
    hdim_2                   (index) float64 187.5 59.12 227.8 ... 488.0 386.0
    num                      (index) int64 75 5 7 5 111 17 ... 30 88 10 88 71 21
    threshold_value          (index) int64 30 30 30 30 30 30 ... 50 50 50 50 50
    ...                       ...
    time                     (index) object 2008-04-11 18:12:23 ... 2008-04-1...
    timestr                  (index) object &#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-0...
    projection_y_coordinate  (index) float64 -3.348e+04 -2.145e+04 ... 1.695e+04
    projection_x_coordinate  (index) float64 -5.611e+04 -1.204e+05 ... 4.331e+04
    latitude                 (index) float64 34.34 34.45 34.52 ... 34.66 34.8
    longitude                (index) float64 -87.38 -88.08 ... -85.74 -86.3</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5b70fa32-d548-46cb-b021-56fa12331550' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5b70fa32-d548-46cb-b021-56fa12331550' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>index</span>: 1499</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b3d54e11-b9a2-4b84-895f-6a2e1f0f0f46' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b3d54e11-b9a2-4b84-895f-6a2e1f0f0f46' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>index</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 1495 1496 1497 1498</div><input id='attrs-76424dd8-991d-43fa-98eb-cf9f050e6a9e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76424dd8-991d-43fa-98eb-cf9f050e6a9e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-696d5dec-7cdb-4420-a52e-44142acc14c8' class='xr-var-data-in' type='checkbox'><label for='data-696d5dec-7cdb-4420-a52e-44142acc14c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 1496, 1497, 1498])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ccca0f72-781f-46fb-abc4-922e5f0133e5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ccca0f72-781f-46fb-abc4-922e5f0133e5' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>frame</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 ... 24 24 24 24 24 24</div><input id='attrs-11d165c2-08d4-4c5d-b0ba-810c9308ec59' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-11d165c2-08d4-4c5d-b0ba-810c9308ec59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1a4cdf5-cdf0-4d80-a8b2-434913fe3d71' class='xr-var-data-in' type='checkbox'><label for='data-d1a4cdf5-cdf0-4d80-a8b2-434913fe3d71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  0,  0, ..., 24, 24, 24])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>idx</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 4 6 8 9 ... 121 122 124 125 126</div><input id='attrs-23aff5a0-dcee-4dda-8ec8-26d96ac1e229' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-23aff5a0-dcee-4dda-8ec8-26d96ac1e229' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2465e578-fb80-42c2-ace5-34a84b272ae5' class='xr-var-data-in' type='checkbox'><label for='data-2465e578-fb80-42c2-ace5-34a84b272ae5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  3,   4,   6, ..., 124, 125, 126])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_1</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>232.7 256.7 271.0 ... 303.1 333.3</div><input id='attrs-e31c6b98-661a-4a17-820a-244d58ee0b0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e31c6b98-661a-4a17-820a-244d58ee0b0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a14b4f3a-dae6-4f94-8d0c-9f166b4841f9' class='xr-var-data-in' type='checkbox'><label for='data-a14b4f3a-dae6-4f94-8d0c-9f166b4841f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([232.65435517, 256.67912935, 271.        , ..., 306.31998979,
       303.06487437, 333.33498034])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hdim_2</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>187.5 59.12 227.8 ... 488.0 386.0</div><input id='attrs-1739257c-983e-440d-8be2-075cab08f014' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1739257c-983e-440d-8be2-075cab08f014' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6f5aee38-3182-4f27-909a-fb13c967b4f1' class='xr-var-data-in' type='checkbox'><label for='data-6f5aee38-3182-4f27-909a-fb13c967b4f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([187.47522731,  59.12016048, 227.81785163, ..., 384.75120982,
       488.02890335, 385.97782823])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>num</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>75 5 7 5 111 17 ... 88 10 88 71 21</div><input id='attrs-6ba23ca3-63c9-462e-a466-a7b9a73118e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ba23ca3-63c9-462e-a466-a7b9a73118e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44ba33fb-5f7c-412f-936b-81708bdb0264' class='xr-var-data-in' type='checkbox'><label for='data-44ba33fb-5f7c-412f-936b-81708bdb0264' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([75,  5,  7, ..., 88, 71, 21])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>threshold_value</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>30 30 30 30 30 ... 50 50 50 50 50</div><input id='attrs-15229bfd-3dc9-414c-94de-6a6178857b66' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-15229bfd-3dc9-414c-94de-6a6178857b66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67e240c1-c7cd-4389-a97f-5f53257c8780' class='xr-var-data-in' type='checkbox'><label for='data-67e240c1-c7cd-4389-a97f-5f53257c8780' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([30, 30, 30, ..., 50, 50, 50])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>feature</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 ... 1496 1497 1498 1499</div><input id='attrs-f51c3c8c-1ee5-4152-a5d6-2b91512f9fa3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f51c3c8c-1ee5-4152-a5d6-2b91512f9fa3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d6cbe3a-78d9-4feb-a06f-f2ccf8785b07' class='xr-var-data-in' type='checkbox'><label for='data-0d6cbe3a-78d9-4feb-a06f-f2ccf8785b07' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   1,    2,    3, ..., 1497, 1498, 1499])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2008-04-11 18:12:23 ... 2008-04-...</div><input id='attrs-facc3e5a-db94-4166-b13f-1e01659d2165' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-facc3e5a-db94-4166-b13f-1e01659d2165' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b7ffa5f-4848-4e70-9f3c-b536ce3c00e9' class='xr-var-data-in' type='checkbox'><label for='data-7b7ffa5f-4848-4e70-9f3c-b536ce3c00e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 18, 12, 23, 0, has_year_zero=False),
       ...,
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2008, 4, 11, 20, 20, 58, 0, has_year_zero=False)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>timestr</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;2008-04-11 18:12:23&#x27; ... &#x27;2008-...</div><input id='attrs-598062e9-e69b-4bae-8abf-09e42656fc14' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-598062e9-e69b-4bae-8abf-09e42656fc14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43a2dce2-910b-41a2-9bc5-eba8a6065c07' class='xr-var-data-in' type='checkbox'><label for='data-43a2dce2-910b-41a2-9bc5-eba8a6065c07' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11 18:12:23&#x27;, &#x27;2008-04-11 18:12:23&#x27;,
       &#x27;2008-04-11 18:12:23&#x27;, ..., &#x27;2008-04-11 20:20:58&#x27;,
       &#x27;2008-04-11 20:20:58&#x27;, &#x27;2008-04-11 20:20:58&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_y_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.348e+04 -2.145e+04 ... 1.695e+04</div><input id='attrs-68caa6e6-a76c-4da8-ab95-7b596cf8909c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-68caa6e6-a76c-4da8-ab95-7b596cf8909c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f8fb637-3b06-4a12-8b84-a1bb869a0a22' class='xr-var-data-in' type='checkbox'><label for='data-1f8fb637-3b06-4a12-8b84-a1bb869a0a22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-33478.62011565, -21446.17895701, -14273.78964942, ...,
         3415.6877058 ,   1785.41287099,  16945.73305692])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>projection_x_coordinate</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.611e+04 -1.204e+05 ... 4.331e+04</div><input id='attrs-deb36970-8d97-4b76-be55-2cd38d39d31e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-deb36970-8d97-4b76-be55-2cd38d39d31e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f97b69cf-b7f1-4365-a106-f03c32a51d72' class='xr-var-data-in' type='checkbox'><label for='data-f97b69cf-b7f1-4365-a106-f03c32a51d72' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ -56105.89617347, -120390.57070987,  -35900.90903251, ...,
         42696.76618874,   94421.8213763 ,   43311.0992813 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>34.34 34.45 34.52 ... 34.66 34.8</div><input id='attrs-cb4273d6-cc10-40c5-a54b-7d8278c42476' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cb4273d6-cc10-40c5-a54b-7d8278c42476' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-175c0cbf-bf0d-4e17-a1a1-056f4ac4803f' class='xr-var-data-in' type='checkbox'><label for='data-175c0cbf-bf0d-4e17-a1a1-056f4ac4803f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([34.34359344, 34.4462889 , 34.51720563, ..., 34.67602827,
       34.65790694, 34.7976789 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.38 -88.08 ... -85.74 -86.3</div><input id='attrs-1b1dc5ad-3ed7-4203-93e5-fd4a416b408d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b1dc5ad-3ed7-4203-93e5-fd4a416b408d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b684cdf-6a27-47e9-b82d-9cff5ac87064' class='xr-var-data-in' type='checkbox'><label for='data-6b684cdf-6a27-47e9-b82d-9cff5ac87064' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-87.3826083 , -88.08444274, -87.16334768, ..., -86.30458467,
       -85.73915096, -86.29716924])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d91593a9-0e54-45e4-a925-3441ac4357a6' class='xr-section-summary-in' type='checkbox'  ><label for='section-d91593a9-0e54-45e4-a925-3441ac4357a6' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>index</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cd33f478-f56f-47e8-ba5f-8e062381d979' class='xr-index-data-in' type='checkbox'/><label for='index-cd33f478-f56f-47e8-ba5f-8e062381d979' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(RangeIndex(start=0, stop=1499, step=1, name=&#x27;index&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-24bfa735-7f99-40c9-9b55-5ab3d0ba6eac' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-24bfa735-7f99-40c9-9b55-5ab3d0ba6eac' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for the linking step:</span>
<span class="n">parameters_linking</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;stubs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#5</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;method_linking&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;predict&#39;</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_stop&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.2</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_step&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#Order of polynomial for extrapolating</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;subnetwork_size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">100</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">3</span><span class="c1">#4</span>
<span class="c1">#parameters_linking[&#39;time_cell_min&#39;]=1</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">30</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;d_min&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">None</span> <span class="c1">#5 </span>

<span class="c1"># Track_df=tobac.linking_trackpy(Features_df,Mask_iris,dt=dt,dxy=dxy,**parameters_linking)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_tracking</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">linking_trackpy</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">dxy</span><span class="o">=</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_linking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frame 24: 75 trajectories present.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_tracking</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame</th>
      <th>idx</th>
      <th>hdim_1</th>
      <th>hdim_2</th>
      <th>num</th>
      <th>threshold_value</th>
      <th>feature</th>
      <th>time</th>
      <th>timestr</th>
      <th>projection_y_coordinate</th>
      <th>projection_x_coordinate</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>cell</th>
      <th>time_cell</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>232.654355</td>
      <td>187.475227</td>
      <td>75</td>
      <td>30</td>
      <td>1</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-33478.620116</td>
      <td>-56105.896173</td>
      <td>34.343593</td>
      <td>-87.382608</td>
      <td>1</td>
      <td>0 days 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>4</td>
      <td>256.679129</td>
      <td>59.120160</td>
      <td>5</td>
      <td>30</td>
      <td>2</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-21446.178957</td>
      <td>-120390.570710</td>
      <td>34.446289</td>
      <td>-88.084443</td>
      <td>-1</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>6</td>
      <td>271.000000</td>
      <td>227.817852</td>
      <td>7</td>
      <td>30</td>
      <td>3</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-14273.789649</td>
      <td>-35900.909033</td>
      <td>34.517206</td>
      <td>-87.163348</td>
      <td>-1</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>8</td>
      <td>291.189565</td>
      <td>62.745582</td>
      <td>5</td>
      <td>30</td>
      <td>4</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>-4162.154494</td>
      <td>-118574.833957</td>
      <td>34.601917</td>
      <td>-88.067061</td>
      <td>-1</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>9</td>
      <td>324.167350</td>
      <td>103.064594</td>
      <td>111</td>
      <td>30</td>
      <td>5</td>
      <td>2008-04-11 18:12:23</td>
      <td>2008-04-11 18:12:23</td>
      <td>12354.265509</td>
      <td>-98381.672359</td>
      <td>34.752573</td>
      <td>-87.848376</td>
      <td>-1</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1494</th>
      <td>24</td>
      <td>121</td>
      <td>181.281622</td>
      <td>275.366252</td>
      <td>88</td>
      <td>50</td>
      <td>1495</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>-59207.868610</td>
      <td>-12087.018954</td>
      <td>34.113660</td>
      <td>-86.902791</td>
      <td>-1</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>1495</th>
      <td>24</td>
      <td>122</td>
      <td>197.820473</td>
      <td>325.438786</td>
      <td>10</td>
      <td>50</td>
      <td>1496</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>-50924.637719</td>
      <td>12991.044798</td>
      <td>34.188142</td>
      <td>-86.630264</td>
      <td>247</td>
      <td>0 days 00:33:48</td>
    </tr>
    <tr>
      <th>1496</th>
      <td>24</td>
      <td>124</td>
      <td>306.319990</td>
      <td>384.751210</td>
      <td>88</td>
      <td>50</td>
      <td>1497</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>3415.687706</td>
      <td>42696.766189</td>
      <td>34.676028</td>
      <td>-86.304585</td>
      <td>158</td>
      <td>0 days 01:15:23</td>
    </tr>
    <tr>
      <th>1497</th>
      <td>24</td>
      <td>125</td>
      <td>303.064874</td>
      <td>488.028903</td>
      <td>71</td>
      <td>50</td>
      <td>1498</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>1785.412871</td>
      <td>94421.821376</td>
      <td>34.657907</td>
      <td>-85.739151</td>
      <td>23</td>
      <td>0 days 02:08:35</td>
    </tr>
    <tr>
      <th>1498</th>
      <td>24</td>
      <td>126</td>
      <td>333.334980</td>
      <td>385.977828</td>
      <td>21</td>
      <td>50</td>
      <td>1499</td>
      <td>2008-04-11 20:20:58</td>
      <td>2008-04-11 20:20:58</td>
      <td>16945.733057</td>
      <td>43311.099281</td>
      <td>34.797679</td>
      <td>-86.297169</td>
      <td>242</td>
      <td>0 days 00:38:59</td>
    </tr>
  </tbody>
</table>
<p>1499 rows × 15 columns</p>
</div></div></div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="d-tracking">
<h1>3d Tracking<a class="headerlink" href="#d-tracking" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<div class="section" id="notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube">
<h2>Notice that the field we’re tracking on has switched from the 2d composite reflectivity field to the 3D reflectivity field (still in an iris cube).<a class="headerlink" href="#notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">grid_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="c1"># Features.to_netcdf(os.path.join(savedir,&#39;Features.nc&#39;))</span>
<span class="c1"># print(&#39;features saved&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting feature detection based on multiple thresholds
feature detection done
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_tracking</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">linking_trackpy</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">dxy</span><span class="o">=</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_linking</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Frame 21: 1 trajectories present.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/mambaforge/envs/ams-open-radar-2023-dev/lib/python3.10/site-packages/trackpy/predict.py:227: UserWarning: Could not generate velocity field for prediction: no tracks
  warn(&#39;Could not generate velocity field for prediction: no tracks&#39;)
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/tobac"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">TOBAC Tutorial</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../pydda/README.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PyDDA</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </div>
          </div>
        </main>

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer">
  <div class="container-fluid m-0 p-0">
  
    <div class="footer-item">
    
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Argonne" src="../../_images/argonne_logo.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Environment_Canda" src="../../_images/environment_canada_logo.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Meteoswiss" src="../../_images/meteoswiss_logo.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Bonne" src="../../_images/university_bonn.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NCAR-contemp-logo-blue.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="CSU" src="../../_images/csu-logo.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAH" src="../../_images/uah-logo.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="TT" src="../../_images/texas-tech-logo.png" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
    <div class="footer-item">
      <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2023.
        
          By the <a href="https://openradarscience.org/">Open Radar</a> Community.
        
          Last updated on 23 August 2023.
        </p>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
  </div>
</footer>
  </body>
</html>