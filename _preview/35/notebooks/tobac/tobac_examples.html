
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D tobac Tutorial: Gridded Radar Data &#8212; AMS Open Radar Short Course 2023</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PyDDA" href="../pydda/README.html" />
    <link rel="prev" title="TOBAC Tutorial" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="132">
    <div class="container-fluid" id="shim"></div>
    <div class="container-fluid" id="banner"></div>
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://openradarscience.org">
  <img src="../../_static/pythia_logo-white-rtext.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://openradarscience.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/radar-cookbook">Radar Cookbook</a>
  </li>
  
  
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openradar" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" rel="noopener" target="_blank" title="YouTube">
            <span><i class="fab fa-youtube-square"></i></span>
            <label class="sr-only">YouTube</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    <div class="container-xl">
      <div class="row">
        
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   AMS Open Radar Short Course 2023
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pyart/README.html">
   Py-ART Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-basics.html">
     Py-ART Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-corrections.html">
     Py-ART Corrections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-gridding.html">
     Py-ART Gridding
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../wradlib/README.html">
   Wradlib Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_intro.html">
     An Overview of wradlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_radar_data_io_vis.html">
     wradlib radar data io, visualisation, gridding and gis export
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_data_quality.html">
     wradlib data quality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_differential_phase.html">
     wradlib Phase Processing - System PhiDP - ZPHI-Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../wradlib/wradlib_quasi_vertical_profiles.html">
     wradlib time series data and quasi vertical profiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lrose/README.html">
   LROSE Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lrose/LROSE_Wind_tutorial.html">
     LROSE Wind Tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   TOBAC Tutorial
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3D
     <em>
      tobac
     </em>
     Tutorial: Gridded Radar Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pydda/README.html">
   PyDDA
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pydda/Retrieving_winds_with_pydda.html">
     PyDDA tutorial
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../baltrad/README.html">
   BALTRAD Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20Compositing.html">
     Compositing with BALTRAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20DRQC.html">
     In this notebook, we will use the depolarization ratio to quality control a volume of data from the new radar at Radisson, Saskatchewan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20IO.html">
     BALTRAD I/O model - making sense out of data and metadata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20parallel%20processing.html">
     BALTRAD parallel processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20QC.html">
     BALTRAD Quality Control
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by <a href="https://projectpythia.org">Project Pythia</a>.<br><br>
All code in Pythia Cookbooks is licensed under Apache 2.0. All other non-code content is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons BY 4.0 (CC BY 4.0)</a>.<br><br>

</div>

</div>

        

        <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main"><div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/tobac/tobac_examples.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/openradar/ams-open-radar-2023/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/openradar/ams-open-radar-2023//issues/new?title=Issue%20on%20page%20%2Fnotebooks/tobac/tobac_examples.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/openradar/ams-open-radar-2023/edit/main/notebooks/tobac/tobac_examples.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="http://binder.projectpythia.org/v2/gh/openradar/ams-open-radar-2023/main?urlpath=lab/tree/notebooks/tobac/tobac_examples.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jupyterhub-workshop.svcs.arm.gov//hub/user-redirect/git-pull?repo=https://github.com/openradar/ams-open-radar-2023/&urlpath=lab/tree/ams-open-radar-2023/notebooks/tobac/tobac_examples.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> On this page
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   3D
   <em>
    tobac
   </em>
   Tutorial: Gridded Radar Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imports">
     Imports
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-preprocess-data">
     Load and Preprocess Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-input">
     DATA INPUT:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-datawe-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters">
       <em>
        tobac
       </em>
       is designed to work with
       <strong>
        gridded
       </strong>
       data currently, so using pre-gridded data, or datawe must first grid the radial radar data. This is a quick and dirty gridding, but it will get the job done for this tutorial. Much better gridding results could be had with tuning of the parameters.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both">
       Let’s Look at the data - there’s a number of ways to do a quick look, we’re going to use pcolormesh. We can look at a specific level of the data, or create a composite reflectivity. Let’s do both!
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d">
     We’re going to start simple before getting more complicated: tracking in 2D
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-thresholds">
   Multiple Thresholds
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-tracking">
   3d Tracking
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube">
     Notice that the field we’re tracking on has switched from the 2d composite reflectivity field to the 3D reflectivity field (still in an iris cube).
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
          <div id="main-content" class="row">
            <div class="col-12 col-md-9 pl-md-3 pr-md-0">
              
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="d-tobac-tutorial-gridded-radar-data">
<h1>3D <em>tobac</em> Tutorial: Gridded Radar Data<a class="headerlink" href="#d-tobac-tutorial-gridded-radar-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<p>This tutorial will demonstrate how to use <em>tobac</em> to detect and track convection with gridded radar data. Because this tutorial uses 3D feature detection, you must use the v1.5 (3D and PBC changes) of <em>tobac</em>.</p>
<p>This tutorial requires the use of pre-gridded radar data, which is available for download at a <a class="reference external" href="https://zenodo.org/record/8184875">Zenodo link</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span>https://zenodo.org/record/8184875/files/20080411_all_gridded.nc

<span class="c1"># Or use the following if you are on MacOS</span>
<span class="c1"># curl https://zenodo.org/record/8184875/files/20080411_all_gridded.nc -o 20080411_all_gridded.nc</span>
</pre></div>
</div>
</div>
</div>
<p>Note that this tutorial also requires Py-ART to grid the radar data.</p>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pyart</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/xarray/backends/cfgrib_.py:29: UserWarning: Failed to load cfgrib - most likely there is a problem accessing the ecCodes library. Try `import cfgrib` to get the full error message
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>## You are using the Python ARM Radar Toolkit (Py-ART), an open source
## library for working with weather radar data. Py-ART is partly
## supported by the U.S. Department of Energy as part of the Atmospheric
## Radiation Measurement (ARM) Climate Research Facility, an Office of
## Science user facility.
##
## If you use this software to prepare a publication, please cite:
##
##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-and-preprocess-data">
<h2>Load and Preprocess Data<a class="headerlink" href="#load-and-preprocess-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read the data that is in antenna coordinates for all radars</span>
<span class="c1"># all_radar_gridded = dict()</span>
<span class="c1"># for radar_file_name in sorted(glob.glob(path+&quot;*.nc&quot;)):</span>
<span class="c1">#     radar_time_str = radar_file_name.split(&#39;_&#39;)[-2]#[:-3]</span>
<span class="c1">#     radar_time  = datetime.datetime.strptime(radar_time_str, &#39;%Y%m%d%H%M%S&#39;)</span>
<span class="c1">#     all_radar_gridded[radar_time] = pyart.io.read_grid(radar_file_name)</span>
    <span class="c1"># data = pyart.io.read_grid(radar_file_name)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># all_xr_grids = list()</span>
<span class="c1"># for radar_time in all_radar_gridded:</span>
<span class="c1">#     all_xr_grids.append(all_radar_gridded[radar_time].to_xarray())</span>
<span class="c1"># #     </span>
<span class="c1"># all_xr_data = xr.concat(all_xr_grids, &#39;time&#39;)</span>
<span class="c1"># all_xr_data.to_netcdf(path+&quot;20080411_all_gridded.nc&quot;)</span>
<span class="c1"># all_xr_data = xr.open_dataset(path+&quot;all-data-gridded.nc&quot;)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-input">
<h2>DATA INPUT:<a class="headerlink" href="#data-input" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>https://tobac.readthedocs.io/en/latest/data_input.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_xr_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;20080411_all_gridded.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/xarray/backends/plugins.py:64: RuntimeWarning: Engine &#39;cfgrib&#39; loading failed:
Cannot find the ecCodes library
  warnings.warn(f&quot;Engine {name!r} loading failed:\n{ex}&quot;, RuntimeWarning)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_xr_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (time: 52, z: 31, y: 601, x: 601)
Coordinates:
  * time          (time) datetime64[ns] 2008-04-11T18:12:23 ... 2008-04-11T20...
  * z             (z) float64 0.0 500.0 1e+03 ... 1.4e+04 1.45e+04 1.5e+04
    lat           (y) float64 33.29 33.29 33.3 33.3 ... 35.97 35.97 35.98 35.98
    lon           (x) float64 -88.39 -88.38 -88.37 ... -85.17 -85.16 -85.16
  * y             (y) float64 -1.5e+05 -1.495e+05 ... 1.495e+05 1.5e+05
  * x             (x) float64 -1.5e+05 -1.495e+05 ... 1.495e+05 1.5e+05
Data variables:
    reflectivity  (time, z, y, x) float32 ...
    ROI           (time, z, y, x) float32 ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e4622723-4acf-4d7f-ad5b-6c468625c2d5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e4622723-4acf-4d7f-ad5b-6c468625c2d5' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 52</li><li><span class='xr-has-index'>z</span>: 31</li><li><span class='xr-has-index'>y</span>: 601</li><li><span class='xr-has-index'>x</span>: 601</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-19a35959-f75e-448a-94c6-cdfecb2dee91' class='xr-section-summary-in' type='checkbox'  checked><label for='section-19a35959-f75e-448a-94c6-cdfecb2dee91' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2008-04-11T18:12:23 ... 2008-04-...</div><input id='attrs-27cfc32a-6343-4f48-baae-df932f7786d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-27cfc32a-6343-4f48-baae-df932f7786d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d272978a-cf94-482c-8ada-47316a3709b9' class='xr-var-data-in' type='checkbox'><label for='data-d272978a-cf94-482c-8ada-47316a3709b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11T18:12:23.000000000&#x27;, &#x27;2008-04-11T18:16:31.000000000&#x27;,
       &#x27;2008-04-11T18:17:23.000000000&#x27;, &#x27;2008-04-11T18:21:31.000000000&#x27;,
       &#x27;2008-04-11T18:22:42.000000000&#x27;, &#x27;2008-04-11T18:26:49.000000000&#x27;,
       &#x27;2008-04-11T18:27:41.000000000&#x27;, &#x27;2008-04-11T18:32:16.000000000&#x27;,
       &#x27;2008-04-11T18:33:08.000000000&#x27;, &#x27;2008-04-11T18:37:44.000000000&#x27;,
       &#x27;2008-04-11T18:38:35.000000000&#x27;, &#x27;2008-04-11T18:43:26.000000000&#x27;,
       &#x27;2008-04-11T18:44:18.000000000&#x27;, &#x27;2008-04-11T18:48:52.000000000&#x27;,
       &#x27;2008-04-11T18:49:44.000000000&#x27;, &#x27;2008-04-11T18:54:20.000000000&#x27;,
       &#x27;2008-04-11T18:55:11.000000000&#x27;, &#x27;2008-04-11T18:59:14.000000000&#x27;,
       &#x27;2008-04-11T19:00:23.000000000&#x27;, &#x27;2008-04-11T19:04:26.000000000&#x27;,
       &#x27;2008-04-11T19:05:35.000000000&#x27;, &#x27;2008-04-11T19:09:39.000000000&#x27;,
       &#x27;2008-04-11T19:10:47.000000000&#x27;, &#x27;2008-04-11T19:14:51.000000000&#x27;,
       &#x27;2008-04-11T19:15:59.000000000&#x27;, &#x27;2008-04-11T19:20:19.000000000&#x27;,
       &#x27;2008-04-11T19:21:11.000000000&#x27;, &#x27;2008-04-11T19:25:32.000000000&#x27;,
       &#x27;2008-04-11T19:26:22.000000000&#x27;, &#x27;2008-04-11T19:30:26.000000000&#x27;,
       &#x27;2008-04-11T19:31:35.000000000&#x27;, &#x27;2008-04-11T19:35:55.000000000&#x27;,
       &#x27;2008-04-11T19:36:46.000000000&#x27;, &#x27;2008-04-11T19:40:50.000000000&#x27;,
       &#x27;2008-04-11T19:41:59.000000000&#x27;, &#x27;2008-04-11T19:46:18.000000000&#x27;,
       &#x27;2008-04-11T19:47:10.000000000&#x27;, &#x27;2008-04-11T19:51:30.000000000&#x27;,
       &#x27;2008-04-11T19:52:22.000000000&#x27;, &#x27;2008-04-11T19:56:43.000000000&#x27;,
       &#x27;2008-04-11T19:57:34.000000000&#x27;, &#x27;2008-04-11T20:03:30.000000000&#x27;,
       &#x27;2008-04-11T20:04:21.000000000&#x27;, &#x27;2008-04-11T20:08:57.000000000&#x27;,
       &#x27;2008-04-11T20:09:49.000000000&#x27;, &#x27;2008-04-11T20:14:22.000000000&#x27;,
       &#x27;2008-04-11T20:15:30.000000000&#x27;, &#x27;2008-04-11T20:19:49.000000000&#x27;,
       &#x27;2008-04-11T20:20:58.000000000&#x27;, &#x27;2008-04-11T20:25:34.000000000&#x27;,
       &#x27;2008-04-11T20:26:25.000000000&#x27;, &#x27;2008-04-11T20:30:58.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>z</span></div><div class='xr-var-dims'>(z)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 500.0 ... 1.45e+04 1.5e+04</div><input id='attrs-a5fd4861-7486-4d4a-ac3e-aafa5b5d4320' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5fd4861-7486-4d4a-ac3e-aafa5b5d4320' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff07f3f0-6c85-4ed3-b2ad-e94a9af6bd30' class='xr-var-data-in' type='checkbox'><label for='data-ff07f3f0-6c85-4ed3-b2ad-e94a9af6bd30' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_z_coordinate</dd><dt><span>long_name :</span></dt><dd>Z distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>array([    0.,   500.,  1000.,  1500.,  2000.,  2500.,  3000.,  3500.,  4000.,
        4500.,  5000.,  5500.,  6000.,  6500.,  7000.,  7500.,  8000.,  8500.,
        9000.,  9500., 10000., 10500., 11000., 11500., 12000., 12500., 13000.,
       13500., 14000., 14500., 15000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ddf35b0d-32da-4cf2-9ca1-4d760adebc24' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ddf35b0d-32da-4cf2-9ca1-4d760adebc24' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d335e97-382c-4730-adff-6b87e96e9a06' class='xr-var-data-in' type='checkbox'><label for='data-0d335e97-382c-4730-adff-6b87e96e9a06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_N</dd><dt><span>standard_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>array([33.28654 , 33.291036, 33.295532, ..., 35.974909, 35.979404, 35.9839  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d9cf9621-060e-47ca-aea2-aef5abde3f3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9cf9621-060e-47ca-aea2-aef5abde3f3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f9ae7d2-a69a-4a64-8daf-a3db054d4a22' class='xr-var-data-in' type='checkbox'><label for='data-3f9ae7d2-a69a-4a64-8daf-a3db054d4a22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_E</dd><dt><span>standard_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>array([-88.385154, -88.379776, -88.374398, ..., -85.168602, -85.163224,
       -85.157846])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-c064d4cc-dbe0-4582-8023-899acd8f30cd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c064d4cc-dbe0-4582-8023-899acd8f30cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bfaf780-7c01-42b1-8f04-0f01c1fdbb65' class='xr-var-data-in' type='checkbox'><label for='data-2bfaf780-7c01-42b1-8f04-0f01c1fdbb65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>long_name :</span></dt><dd>Y distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000., -149500., -149000., ...,  149000.,  149500.,  150000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-0e9b5ec2-cba5-4569-8e0f-78a197f64933' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e9b5ec2-cba5-4569-8e0f-78a197f64933' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26df0cbc-4115-4eaa-b102-a3cd845c5879' class='xr-var-data-in' type='checkbox'><label for='data-26df0cbc-4115-4eaa-b102-a3cd845c5879' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>long_name :</span></dt><dd>X distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000., -149500., -149000., ...,  149000.,  149500.,  150000.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-33f16c00-b574-464b-ba11-4432c6f1109e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-33f16c00-b574-464b-ba11-4432c6f1109e' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity</span></div><div class='xr-var-dims'>(time, z, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c805e792-b8fc-4dbc-bae8-cdd11347116a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c805e792-b8fc-4dbc-bae8-cdd11347116a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2ddb8fd-3168-4ae9-84fd-af3e9c9e921b' class='xr-var-data-in' type='checkbox'><label for='data-f2ddb8fd-3168-4ae9-84fd-af3e9c9e921b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd><dt><span>coordinates :</span></dt><dd>elevation azimuth range</dd></dl></div><div class='xr-var-data'><pre>[582256012 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ROI</span></div><div class='xr-var-dims'>(time, z, y, x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-52cff48c-e88d-4847-8b89-16f127c486b1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-52cff48c-e88d-4847-8b89-16f127c486b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1068c4a-4d07-482b-a0f8-fed5ca21953e' class='xr-var-data-in' type='checkbox'><label for='data-b1068c4a-4d07-482b-a0f8-fed5ca21953e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Radius of influence for mapping</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>standard_name :</span></dt><dd>radius_of_influence</dd></dl></div><div class='xr-var-data'><pre>[582256012 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fffdeee9-0b79-4b62-b5a3-c3d894747565' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fffdeee9-0b79-4b62-b5a3-c3d894747565' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="section" id="tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-datawe-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters">
<h3><em>tobac</em> is designed to work with <strong>gridded</strong> data currently, so using pre-gridded data, or datawe must first grid the radial radar data. This is a quick and dirty gridding, but it will get the job done for this tutorial. Much better gridding results could be had with tuning of the parameters.<a class="headerlink" href="#tobac-is-designed-to-work-with-gridded-data-currently-so-using-pre-gridded-data-or-datawe-must-first-grid-the-radial-radar-data-this-is-a-quick-and-dirty-gridding-but-it-will-get-the-job-done-for-this-tutorial-much-better-gridding-results-could-be-had-with-tuning-of-the-parameters" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
</div>
<div class="section" id="lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both">
<h3>Let’s Look at the data - there’s a number of ways to do a quick look, we’re going to use pcolormesh. We can look at a specific level of the data, or create a composite reflectivity. Let’s do both!<a class="headerlink" href="#lets-look-at-the-data-theres-a-number-of-ways-to-do-a-quick-look-were-going-to-use-pcolormesh-we-can-look-at-a-specific-level-of-the-data-or-create-a-composite-reflectivity-lets-do-both" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Looking at a specific level and time of our data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">all_xr_data</span><span class="p">[</span><span class="s1">&#39;reflectivity&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,:,:])</span>
<span class="c1"># plt.pcolormesh(maxrefl[2,:,:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe1fa99cd30&gt;
</pre></div>
</div>
<img alt="../../_images/9362567fdab197cdc2847e6cf91328e6245e6a039e2fe9b27cebd48e7501f8ac.png" src="../../_images/9362567fdab197cdc2847e6cf91328e6245e6a039e2fe9b27cebd48e7501f8ac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#QUICK COMPOSITE REFLECTIVITY HERE:</span>
<span class="n">maxrefl</span> <span class="o">=</span> <span class="n">all_xr_data</span><span class="p">[</span><span class="s1">&#39;reflectivity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="mi">20</span><span class="p">,:,:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe1c8a87c40&gt;
</pre></div>
</div>
<img alt="../../_images/c97cd8b260c87984c56c11a89aa5381f9a0a712fc2d9a62ef6fccd576402e53f.png" src="../../_images/c97cd8b260c87984c56c11a89aa5381f9a0a712fc2d9a62ef6fccd576402e53f.png" />
</div>
</div>
<p>Load in <em>tobac</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tobac</span>
<span class="kn">import</span> <span class="nn">tobac.testing</span>
<span class="kn">import</span> <span class="nn">tobac.feature_detection</span>
<span class="kn">import</span> <span class="nn">tobac.segmentation</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/iris/fileformats/_ff.py:819: DeprecationWarning: `np.float` is a deprecated alias for the builtin `float`. To silence this warning, use `float` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.float64` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  def _parse_binary_stream(file_like, dtype=np.float, count=-1):
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/pyke/knowledge_engine.py:28: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#39;s documentation for alternative uses
  import imp
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/sklearn/utils/multiclass.py:14: DeprecationWarning: Please use `spmatrix` from the `scipy.sparse` namespace, the `scipy.sparse.base` namespace is deprecated.
  from scipy.sparse.base import spmatrix
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/sklearn/utils/optimize.py:18: DeprecationWarning: Please use `line_search_wolfe2` from the `scipy.optimize` namespace, the `scipy.optimize.linesearch` namespace is deprecated.
  from scipy.optimize.linesearch import line_search_wolfe2, line_search_wolfe1
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/sklearn/utils/optimize.py:18: DeprecationWarning: Please use `line_search_wolfe1` from the `scipy.optimize` namespace, the `scipy.optimize.linesearch` namespace is deprecated.
  from scipy.optimize.linesearch import line_search_wolfe2, line_search_wolfe1
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/trackpy/preprocessing.py:4: DeprecationWarning: Please use `uniform_filter1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import uniform_filter1d, correlate1d
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/trackpy/preprocessing.py:4: DeprecationWarning: Please use `correlate1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import uniform_filter1d, correlate1d
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/trackpy/preprocessing.py:5: DeprecationWarning: Please use `fourier_gaussian` from the `scipy.ndimage` namespace, the `scipy.ndimage.fourier` namespace is deprecated.
  from scipy.ndimage.fourier import fourier_gaussian
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_detection_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">]</span><span class="c1">#, 40, 50]</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;maximum&#39;</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;position_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;weighted_diff&#39;</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;n_erosion_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;sigma_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;n_min_threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
<p>Note that to track in 3D, we must give information about what our height coordinate is. Iris tends to be picky about the naming conventions, so we need to assign standard names as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr_grid_full</span> <span class="o">=</span> <span class="n">all_xr_data</span><span class="p">[</span><span class="s1">&#39;reflectivity&#39;</span><span class="p">]</span>
<span class="n">xr_grid_full</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_xr_data</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;altitude&#39;</span><span class="p">})</span>
<span class="n">xr_grid_full</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_xr_data</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">})</span>
<span class="n">xr_grid_full</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_xr_data</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span><span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Even though we read in our data using Xarray, and Xarray is our data handler of choice (could also be Pandas)</span>
<span class="c1">#we need to conver this data to iris cubes. Future versions of tobac will be built on Xarray, but for now we convert.</span>
<span class="n">grid_iris</span> <span class="o">=</span> <span class="n">xr_grid_full</span><span class="o">.</span><span class="n">to_iris</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># #FURTHER, to use tobac we need to know the grid spacing in both x/y/z and time:</span>
<span class="c1"># # #Dt, DXY</span>
<span class="c1"># datetimes = xr_grid_full[&#39;time&#39;]</span>
<span class="c1"># timedeltas = [(datetimes[i-1]-datetimes[i]).astype(&#39;timedelta64[m]&#39;) for i in range(1, len(datetimes))]</span>
<span class="c1"># print(len(timedeltas))</span>
<span class="c1"># average_timedelta = sum(timedeltas) / len(timedeltas)</span>
<span class="c1"># dt = np.abs(np.array(average_timedelta)).astype(&#39;timedelta64[m]&#39;).astype(int)</span>


<span class="c1"># deltax = [xr_grid_full[&#39;x&#39;][i-1]-xr_grid_full[&#39;x&#39;][i] for i in range(1, len(xr_grid_full[&#39;x&#39;]))]</span>
<span class="c1"># dxy = np.abs(np.mean(deltax).astype(int))/1000</span>


<span class="c1"># print(dxy,dt)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dxy</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_spacings</span><span class="p">(</span><span class="n">grid_iris</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dxy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>500.0
248
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#I also want to define a save directory. </span>
<span class="c1">#Set up directory to save output and plots:</span>
<span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;tobac_Save&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">savedir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">savedir</span><span class="p">)</span>
<span class="n">plot_dir</span><span class="o">=</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/tobac_Plot&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">plot_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d">
<h2>We’re going to start simple before getting more complicated: tracking in 2D<a class="headerlink" href="#were-going-to-start-simple-before-getting-more-complicated-tracking-in-2d" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Create a composite reflectivity to get started, turning our 3D reflectivity into 2D:</span>
<span class="n">maxrefl</span> <span class="o">=</span> <span class="n">xr_grid_full</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Convert to iris:</span>
<span class="n">maxrefl_iris</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="o">.</span><span class="n">to_iris</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">maxrefl_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="n">Features</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Features.nc&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;features saved&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for segmentation step:</span>
<span class="n">parameters_segmentation</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_segmentation</span><span class="p">[</span><span class="s1">&#39;method&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;watershed&#39;</span>
<span class="n">parameters_segmentation</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">30</span> 
<span class="c1">#parameters_segmentation[&#39;features&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;field&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;dxy&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;target&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;level&#39;]</span>
<span class="c1">#parameters_segmentation[&#39;max_distance&#39;]</span>
<span class="c1">#Maximum distance from a marker allowed to be classified as</span>
        <span class="c1">#belonging to that cell. Default is None.</span>
<span class="c1">#parameters_segmentation[&#39;vertical_coord&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Features_df=Features.to_dataframe()</span>

<span class="c1"># Perform Segmentation and save resulting mask to NetCDF file:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting segmentation based on reflectivity&#39;</span><span class="p">)</span>
<span class="n">Mask_iris</span><span class="p">,</span><span class="n">Features_Precip</span> <span class="o">=</span><span class="n">tobac</span><span class="o">.</span><span class="n">segmentation</span><span class="o">.</span><span class="n">segmentation</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span><span class="n">maxrefl_iris</span><span class="p">,</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_segmentation</span><span class="p">)</span>

<span class="n">Mask</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="o">.</span><span class="n">from_iris</span><span class="p">(</span><span class="n">Mask_iris</span><span class="p">)</span>
<span class="n">Mask</span> <span class="o">=</span> <span class="n">Mask</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">()</span>


<span class="c1">#Mask,Features_Precip=segmentation(Features,maxrefl,dxy,**parameters_segmentation)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;segmentation based on reflectivity performed, start saving results to files&#39;</span><span class="p">)</span>
<span class="n">Mask</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Mask_Segmentation_refl.nc&#39;</span><span class="p">))</span>                
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for the linking step:</span>
<span class="n">parameters_linking</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;stubs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#5</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;method_linking&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;predict&#39;</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_stop&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.2</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_step&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#Order of polynomial for extrapolating</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;subnetwork_size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">100</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">3</span><span class="c1">#4</span>
<span class="c1">#parameters_linking[&#39;time_cell_min&#39;]=1</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.6</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;d_min&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">None</span> <span class="c1">#5 </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform trajectory linking using trackpy and save the resulting DataFrame:</span>

<span class="n">Track_df</span><span class="o">=</span><span class="n">tobac</span><span class="o">.</span><span class="n">linking_trackpy</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span><span class="n">Mask_iris</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">dxy</span><span class="o">=</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_linking</span><span class="p">)</span>

<span class="n">Track</span> <span class="o">=</span> <span class="n">Track_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>

<span class="n">Track</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">savedir</span><span class="p">,</span><span class="s1">&#39;Track.nc&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">merge_split</span><span class="o">.</span><span class="n">merge_split_MEST</span><span class="p">(</span><span class="n">Track_df</span><span class="p">,</span><span class="mf">500.</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">25000.0</span><span class="p">)</span>

<span class="n">Track</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Track.nc&quot;</span><span class="p">)</span>
<span class="c1"># ds = tobac.utils.standardize_track_dataset(Track, refl_mask)#, data[&#39;ProjectionCoordinateSystem&#39;])</span>
<span class="c1"># both_ds = xarray.merge([ds, d],compat =&#39;override&#39;)</span>

<span class="c1"># both_ds = tobac.utils.compress_all(both_ds)</span>
<span class="c1"># both_ds.to_netcdf(os.path.join(savedir,&#39;Track_features_merges.nc&#39;))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Track</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Track.nc&quot;</span><span class="p">)</span>
<span class="n">Features</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Features.nc&quot;</span><span class="p">)</span>
<span class="n">refl_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">savedir</span><span class="o">+</span><span class="s2">&quot;/Mask_Segmentation_refl.nc&quot;</span><span class="p">)</span>

<span class="c1"># both_ds = xarray.open_dataset(savedir+&#39;/Track_features_merges.nc&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">isolated_min</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">show_tracks</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ref_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">refl</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="p">[</span><span class="n">frame</span><span class="p">,:,:]</span> 
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    
<span class="n">refplt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">refl</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="n">levels</span> <span class="o">=</span> <span class="n">ref_levels</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_LangRainbow12&#39;</span><span class="p">,</span><span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">24</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span><span class="c1">#,extent = [0,-10000,-20000,-10000])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">refplt</span><span class="p">,</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Mask</span><span class="p">[</span><span class="s1">&#39;segmentation_mask&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">x_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">imcell2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
    


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="c1">#print(i)</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="n">cell_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;feature_parent_cell_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">frame</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">frame</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">],</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">cell_i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
 





<span class="c1">#     fig.savefig(plot_dir+&#39;/&#39;+&#39;20260331_track_&#39;+str(frame)+&#39;.png&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="n">frame</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">isolated_min</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">show_tracks</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ref_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="n">refl</span> <span class="o">=</span> <span class="n">maxrefl</span><span class="p">[</span><span class="n">frame</span><span class="p">,:,:]</span> 
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">maxrefl</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    
<span class="n">refplt</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y_mesh</span><span class="p">,</span><span class="n">x_mesh</span><span class="p">,</span> <span class="n">refl</span><span class="p">,</span> <span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="n">levels</span> <span class="o">=</span> <span class="n">ref_levels</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_LangRainbow12&#39;</span><span class="p">,</span><span class="n">origin</span> <span class="o">=</span> <span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">24</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span><span class="c1">#,extent = [0,-10000,-20000,-10000])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">refplt</span><span class="p">,</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Mask</span><span class="p">[</span><span class="s1">&#39;segmentation_mask&#39;</span><span class="p">][</span><span class="n">frame</span><span class="p">,:,:]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    

<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">y_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span><span class="n">x_mesh</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">imcell2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
    



<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]:</span>
    <span class="n">track_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;cell_parent_track_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">][</span><span class="n">track_i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">cell</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">feature_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;feature_parent_cell_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">frame</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">frame</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Features</span><span class="p">[</span><span class="s1">&#39;frame&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">])):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">],</span> <span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_x_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Track</span><span class="p">[</span><span class="s1">&#39;projection_y_coordinate&#39;</span><span class="p">][</span><span class="n">feature_id</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span><span class="n">rotation</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>





<span class="c1">#     fig.savefig(plot_dir+&#39;/&#39;+&#39;20260331_track_&#39;+str(frame)+&#39;.png&#39;)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="multiple-thresholds">
<h1>Multiple Thresholds<a class="headerlink" href="#multiple-thresholds" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feature_detection_params</span><span class="p">[</span><span class="s1">&#39;threshold&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr_grid_full</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;reflectivity&#x27; (time: 52, z: 31, y: 601, x: 601)&gt;
array([[[[nan, ..., nan],
         ...,
         [nan, ..., nan]],

        ...,

        [[nan, ..., nan],
         ...,
         [nan, ..., nan]]],


       ...,


       [[[nan, ..., nan],
         ...,
         [nan, ..., nan]],

        ...,

        [[nan, ..., nan],
         ...,
         [nan, ..., nan]]]], dtype=float32)
Coordinates:
  * time     (time) datetime64[ns] 2008-04-11T18:12:23 ... 2008-04-11T20:30:58
  * z        (z) float64 0.0 500.0 1e+03 1.5e+03 ... 1.4e+04 1.45e+04 1.5e+04
    lat      (y) float64 33.29 33.29 33.3 33.3 33.3 ... 35.97 35.97 35.98 35.98
    lon      (x) float64 -88.39 -88.38 -88.37 -88.37 ... -85.17 -85.16 -85.16
  * y        (y) float64 -1.5e+05 -1.495e+05 -1.49e+05 ... 1.495e+05 1.5e+05
  * x        (x) float64 -1.5e+05 -1.495e+05 -1.49e+05 ... 1.495e+05 1.5e+05
Attributes:
    long_name:      Reflectivity
    units:          dBZ
    standard_name:  equivalent_reflectivity_factor
    coordinates:    elevation azimuth range</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'reflectivity'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 52</li><li><span class='xr-has-index'>z</span>: 31</li><li><span class='xr-has-index'>y</span>: 601</li><li><span class='xr-has-index'>x</span>: 601</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f9232d5c-e825-4d29-afad-e9286ebf347f' class='xr-array-in' type='checkbox' checked><label for='section-f9232d5c-e825-4d29-afad-e9286ebf347f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan nan ... nan nan nan nan nan nan nan nan</span></div><div class='xr-array-data'><pre>array([[[[nan, ..., nan],
         ...,
         [nan, ..., nan]],

        ...,

        [[nan, ..., nan],
         ...,
         [nan, ..., nan]]],


       ...,


       [[[nan, ..., nan],
         ...,
         [nan, ..., nan]],

        ...,

        [[nan, ..., nan],
         ...,
         [nan, ..., nan]]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-72e46d62-c049-4d91-9c81-91e124078a18' class='xr-section-summary-in' type='checkbox'  checked><label for='section-72e46d62-c049-4d91-9c81-91e124078a18' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2008-04-11T18:12:23 ... 2008-04-...</div><input id='attrs-d349cf27-5400-45e5-b84d-90b775edb5d6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d349cf27-5400-45e5-b84d-90b775edb5d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3024404-7355-4c80-8503-9b7806c4bf09' class='xr-var-data-in' type='checkbox'><label for='data-f3024404-7355-4c80-8503-9b7806c4bf09' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2008-04-11T18:12:23.000000000&#x27;, &#x27;2008-04-11T18:16:31.000000000&#x27;,
       &#x27;2008-04-11T18:17:23.000000000&#x27;, &#x27;2008-04-11T18:21:31.000000000&#x27;,
       &#x27;2008-04-11T18:22:42.000000000&#x27;, &#x27;2008-04-11T18:26:49.000000000&#x27;,
       &#x27;2008-04-11T18:27:41.000000000&#x27;, &#x27;2008-04-11T18:32:16.000000000&#x27;,
       &#x27;2008-04-11T18:33:08.000000000&#x27;, &#x27;2008-04-11T18:37:44.000000000&#x27;,
       &#x27;2008-04-11T18:38:35.000000000&#x27;, &#x27;2008-04-11T18:43:26.000000000&#x27;,
       &#x27;2008-04-11T18:44:18.000000000&#x27;, &#x27;2008-04-11T18:48:52.000000000&#x27;,
       &#x27;2008-04-11T18:49:44.000000000&#x27;, &#x27;2008-04-11T18:54:20.000000000&#x27;,
       &#x27;2008-04-11T18:55:11.000000000&#x27;, &#x27;2008-04-11T18:59:14.000000000&#x27;,
       &#x27;2008-04-11T19:00:23.000000000&#x27;, &#x27;2008-04-11T19:04:26.000000000&#x27;,
       &#x27;2008-04-11T19:05:35.000000000&#x27;, &#x27;2008-04-11T19:09:39.000000000&#x27;,
       &#x27;2008-04-11T19:10:47.000000000&#x27;, &#x27;2008-04-11T19:14:51.000000000&#x27;,
       &#x27;2008-04-11T19:15:59.000000000&#x27;, &#x27;2008-04-11T19:20:19.000000000&#x27;,
       &#x27;2008-04-11T19:21:11.000000000&#x27;, &#x27;2008-04-11T19:25:32.000000000&#x27;,
       &#x27;2008-04-11T19:26:22.000000000&#x27;, &#x27;2008-04-11T19:30:26.000000000&#x27;,
       &#x27;2008-04-11T19:31:35.000000000&#x27;, &#x27;2008-04-11T19:35:55.000000000&#x27;,
       &#x27;2008-04-11T19:36:46.000000000&#x27;, &#x27;2008-04-11T19:40:50.000000000&#x27;,
       &#x27;2008-04-11T19:41:59.000000000&#x27;, &#x27;2008-04-11T19:46:18.000000000&#x27;,
       &#x27;2008-04-11T19:47:10.000000000&#x27;, &#x27;2008-04-11T19:51:30.000000000&#x27;,
       &#x27;2008-04-11T19:52:22.000000000&#x27;, &#x27;2008-04-11T19:56:43.000000000&#x27;,
       &#x27;2008-04-11T19:57:34.000000000&#x27;, &#x27;2008-04-11T20:03:30.000000000&#x27;,
       &#x27;2008-04-11T20:04:21.000000000&#x27;, &#x27;2008-04-11T20:08:57.000000000&#x27;,
       &#x27;2008-04-11T20:09:49.000000000&#x27;, &#x27;2008-04-11T20:14:22.000000000&#x27;,
       &#x27;2008-04-11T20:15:30.000000000&#x27;, &#x27;2008-04-11T20:19:49.000000000&#x27;,
       &#x27;2008-04-11T20:20:58.000000000&#x27;, &#x27;2008-04-11T20:25:34.000000000&#x27;,
       &#x27;2008-04-11T20:26:25.000000000&#x27;, &#x27;2008-04-11T20:30:58.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>z</span></div><div class='xr-var-dims'>(z)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 500.0 ... 1.45e+04 1.5e+04</div><input id='attrs-d7a5987b-9fa7-4f85-bf20-563c23746a4f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d7a5987b-9fa7-4f85-bf20-563c23746a4f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0f55a81c-e4bc-4953-9403-1ba1e68ee7be' class='xr-var-data-in' type='checkbox'><label for='data-0f55a81c-e4bc-4953-9403-1ba1e68ee7be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>altitude</dd><dt><span>long_name :</span></dt><dd>Z distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>array([    0.,   500.,  1000.,  1500.,  2000.,  2500.,  3000.,  3500.,  4000.,
        4500.,  5000.,  5500.,  6000.,  6500.,  7000.,  7500.,  8000.,  8500.,
        9000.,  9500., 10000., 10500., 11000., 11500., 12000., 12500., 13000.,
       13500., 14000., 14500., 15000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>33.29 33.29 33.3 ... 35.98 35.98</div><input id='attrs-81c56472-a00c-40a3-bc85-f2e377937b70' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-81c56472-a00c-40a3-bc85-f2e377937b70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f2533a2-32db-4d2d-a558-5fb3c5c76b8e' class='xr-var-data-in' type='checkbox'><label for='data-8f2533a2-32db-4d2d-a558-5fb3c5c76b8e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_N</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([33.28654 , 33.291036, 33.295532, ..., 35.974909, 35.979404, 35.9839  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-88.39 -88.38 ... -85.16 -85.16</div><input id='attrs-a10f217a-88a2-4a9b-ad58-c142fe8e55d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a10f217a-88a2-4a9b-ad58-c142fe8e55d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e573d860-69fc-4508-9dea-c77b1f58b630' class='xr-var-data-in' type='checkbox'><label for='data-e573d860-69fc-4508-9dea-c77b1f58b630' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude of grid cell center</dd><dt><span>units :</span></dt><dd>degree_E</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-88.385154, -88.379776, -88.374398, ..., -85.168602, -85.163224,
       -85.157846])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-6ab1e444-d77a-40a5-925c-409193cb45ca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6ab1e444-d77a-40a5-925c-409193cb45ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31880337-ebc6-414e-95cb-6a609c34e917' class='xr-var-data-in' type='checkbox'><label for='data-31880337-ebc6-414e-95cb-6a609c34e917' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_y_coordinate</dd><dt><span>long_name :</span></dt><dd>Y distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000., -149500., -149000., ...,  149000.,  149500.,  150000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.5e+05 -1.495e+05 ... 1.5e+05</div><input id='attrs-d1e20ac8-05e6-4131-822c-bf470e309cbf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1e20ac8-05e6-4131-822c-bf470e309cbf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9a8f34c1-b096-4f89-b0f0-9f12575ee6bc' class='xr-var-data-in' type='checkbox'><label for='data-9a8f34c1-b096-4f89-b0f0-9f12575ee6bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>projection_x_coordinate</dd><dt><span>long_name :</span></dt><dd>X distance on the projection plane from the origin</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([-150000., -149500., -149000., ...,  149000.,  149500.,  150000.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3ff43a39-528b-42f2-9e67-2538d485bcc3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3ff43a39-528b-42f2-9e67-2538d485bcc3' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd><dt><span>coordinates :</span></dt><dd>elevation azimuth range</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">maxrefl_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="c1"># Features.to_netcdf(os.path.join(savedir,&#39;Features.nc&#39;))</span>
<span class="c1"># print(&#39;features saved&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starting feature detection based on multiple thresholds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
/Users/kelcy/opt/anaconda3/envs/TTU_KNB/lib/python3.8/site-packages/skimage/morphology/binary.py:41: DeprecationWarning: `np.bool` is a deprecated alias for the builtin `bool`. To silence this warning, use `bool` by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use `np.bool_` here.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  out = np.empty(image.shape, dtype=np.bool)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>feature detection done
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary containing keyword arguments for the linking step:</span>
<span class="n">parameters_linking</span><span class="o">=</span><span class="p">{}</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;stubs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#5</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;method_linking&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;predict&#39;</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_stop&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.2</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;adaptive_step&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#Order of polynomial for extrapolating</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;subnetwork_size&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">100</span> 
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">3</span><span class="c1">#4</span>
<span class="c1">#parameters_linking[&#39;time_cell_min&#39;]=1</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;v_max&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">30</span>
<span class="n">parameters_linking</span><span class="p">[</span><span class="s1">&#39;d_min&#39;</span><span class="p">]</span><span class="o">=</span> <span class="kc">None</span> <span class="c1">#5 </span>

<span class="c1"># Track_df=tobac.linking_trackpy(Features_df,Mask_iris,dt=dt,dxy=dxy,**parameters_linking)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_tracking</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">linking_trackpy</span><span class="p">(</span><span class="n">Features_df</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span><span class="n">dxy</span><span class="o">=</span><span class="n">dxy</span><span class="p">,</span><span class="o">**</span><span class="n">parameters_linking</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiple_tracking</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="d-tracking">
<h1>3d Tracking<a class="headerlink" href="#d-tracking" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<div class="section" id="notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube">
<h2>Notice that the field we’re tracking on has switched from the 2d composite reflectivity field to the 3D reflectivity field (still in an iris cube).<a class="headerlink" href="#notice-that-the-field-were-tracking-on-has-switched-from-the-2d-composite-reflectivity-field-to-the-3d-reflectivity-field-still-in-an-iris-cube" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#FIND OUR FEATURES!</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting feature detection based on multiple thresholds&#39;</span><span class="p">)</span>
<span class="n">Features_df</span> <span class="o">=</span> <span class="n">tobac</span><span class="o">.</span><span class="n">feature_detection_multithreshold</span><span class="p">(</span><span class="n">grid_iris</span><span class="p">,</span> <span class="n">dxy</span><span class="p">,</span> <span class="o">**</span><span class="n">feature_detection_params</span><span class="p">)</span>

<span class="n">Features</span><span class="o">=</span><span class="n">Features_df</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;feature detection done&#39;</span><span class="p">)</span>

<span class="c1"># Features.to_netcdf(os.path.join(savedir,&#39;Features.nc&#39;))</span>
<span class="c1"># print(&#39;features saved&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># multiple_tracking = tobac.linking_trackpy(Features_df, None, dt=dt,dxy=dxy,**parameters_linking)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/tobac"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">TOBAC Tutorial</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../pydda/README.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PyDDA</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </div>
          </div>
        </main>

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer">
  <div class="container-fluid m-0 p-0">
  
    <div class="footer-item">
    
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NCAR-contemp-logo-blue.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAlbany" src="../../_images/UAlbany-A2-logo-purple-gold.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
    <div class="footer-item">
      <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2023.
        
          By the <a href="https://openradarscience.org/">Open Radar</a> Community.
        
          Last updated on 21 August 2023.
        </p>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
  </div>
</footer>
  </body>
</html>